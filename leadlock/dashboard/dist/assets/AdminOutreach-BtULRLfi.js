import{c as O,r as p,j as e,X as H}from"./index-BHeaMpcx.js";import{a as h}from"./client-CM7usSQg.js";import{P as W}from"./PageHeader-B70tmnmd.js";import{B as q}from"./Badge-CMg_OOW7.js";import{D as J}from"./DataTable-2VHuwdQk.js";import{S as K}from"./StatusDot-BOoImejg.js";import{P as X}from"./plus-uTLkigTW.js";import{T as $}from"./trash-2-BHMdR2CX.js";import"./chevron-down-BThlQuyw.js";import"./chevron-up-B8rptYAu.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=O("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=O("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),b=["cold","contacted","demo_scheduled","demo_completed","proposal_sent","won","lost"],G={cold:"neutral",contacted:"warning",demo_scheduled:"info",demo_completed:"info",proposal_sent:"warning",won:"success",lost:"danger"},Q={cold:"gray",contacted:"yellow",demo_scheduled:"yellow",demo_completed:"yellow",proposal_sent:"yellow",won:"green",lost:"red"},Z=["board","table"],y="bg-white border border-gray-200 text-gray-900 outline-none focus:border-orange-400 focus:ring-2 focus:ring-orange-100 transition-all";function v(a){return(a||"").replace(/_/g," ").replace(/\b\w/g,d=>d.toUpperCase())}function ee({action:a,onCancel:d,onConfirm:r}){if(!a)return null;const n=a.type==="delete";return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200/50 rounded-2xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:n?"Delete Prospect":"Convert to Client"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:n?`Are you sure you want to delete "${a.prospect.prospect_name}"? This cannot be undone.`:`Convert "${a.prospect.prospect_name}" into a LeadLock client? This will create a new client account.`}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{onClick:d,className:"px-4 py-2 rounded-xl text-sm font-medium text-gray-600 bg-white border border-gray-200 hover:border-gray-300 transition-colors cursor-pointer",children:"Cancel"}),e.jsx("button",{onClick:r,className:`px-4 py-2 rounded-xl text-sm font-medium text-white transition-colors cursor-pointer ${n?"bg-red-500 hover:bg-red-600":"bg-emerald-500 hover:bg-emerald-600"}`,children:n?"Delete":"Convert"})]})]})})}function te({show:a,editingId:d,form:r,onFormChange:n,onSave:l,onClose:c}){if(!a)return null;const x=[{label:"Name",key:"prospect_name",type:"text",placeholder:"John Smith"},{label:"Company",key:"prospect_company",type:"text",placeholder:"Smith Plumbing"},{label:"Email",key:"prospect_email",type:"email",placeholder:"john@smithplumbing.com"},{label:"Phone",key:"prospect_phone",type:"text",placeholder:"+15551234567"},{label:"Est. MRR",key:"estimated_mrr",type:"number",placeholder:"997"}];return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"w-full max-w-md bg-white border border-gray-200/50 rounded-2xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:d?"Edit Prospect":"New Prospect"}),e.jsx("button",{onClick:c,className:"text-gray-400 hover:text-gray-600 cursor-pointer",children:e.jsx(H,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-4",children:[x.map(({label:s,key:o,type:m,placeholder:j})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-1.5",children:s}),e.jsx("input",{type:m,value:r[o],onChange:w=>n({...r,[o]:w.target.value}),className:`w-full px-3 py-2.5 rounded-xl text-sm ${y}`,placeholder:j})]},o)),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-1.5",children:"Trade Type"}),e.jsx("select",{value:r.prospect_trade_type,onChange:s=>n({...r,prospect_trade_type:s.target.value}),className:`w-full px-3 py-2.5 rounded-xl text-sm cursor-pointer ${y}`,children:["hvac","plumbing","electrical","roofing","solar","general"].map(s=>e.jsx("option",{value:s,children:s.charAt(0).toUpperCase()+s.slice(1)},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-1.5",children:"Status"}),e.jsx("select",{value:r.status,onChange:s=>n({...r,status:s.target.value}),className:`w-full px-3 py-2.5 rounded-xl text-sm cursor-pointer ${y}`,children:b.map(s=>e.jsx("option",{value:s,children:v(s)},s))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-1.5",children:"Notes"}),e.jsx("textarea",{value:r.notes,onChange:s=>n({...r,notes:s.target.value}),className:`w-full px-3 py-2.5 rounded-xl text-sm resize-none h-20 ${y}`,placeholder:"Notes about the prospect..."})]}),e.jsx("button",{onClick:l,className:"w-full py-2.5 rounded-xl text-sm font-medium text-white bg-orange-500 hover:bg-orange-600 transition-colors cursor-pointer",children:d?"Update Prospect":"Create Prospect"})]})]})})}function se({grouped:a,onEdit:d,onDelete:r,onConvert:n,canConvert:l}){return e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-4",children:b.map(c=>{var x;return e.jsxs("div",{className:"flex-shrink-0 w-60",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 px-1",children:[e.jsx(K,{color:Q[c]||"gray"}),e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:v(c)}),e.jsx("span",{className:"text-xs font-mono ml-auto text-gray-400",children:((x=a[c])==null?void 0:x.length)||0})]}),e.jsx("div",{className:"space-y-2",children:(a[c]||[]).map(s=>e.jsxs("div",{className:"bg-white border border-gray-200/50 rounded-xl p-4 shadow-card cursor-pointer hover:border-gray-300 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",onClick:()=>d(s),children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.prospect_name}),e.jsx("p",{className:"text-xs mt-0.5 text-gray-400",children:s.prospect_company}),s.prospect_phone&&e.jsx("p",{className:"text-xs font-mono text-gray-400 mt-1",children:s.prospect_phone})]}),e.jsxs("div",{className:"flex items-center gap-0.5 ml-2",children:[l(s)&&e.jsx("button",{onClick:o=>{o.stopPropagation(),n(s)},className:"p-1 rounded-lg text-emerald-500 hover:bg-emerald-50 transition-colors cursor-pointer",title:"Convert to client",children:e.jsx(L,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:o=>{o.stopPropagation(),r(s)},className:"p-1 rounded-lg text-gray-400 hover:text-red-500 hover:bg-red-50 transition-colors cursor-pointer",title:"Delete prospect",children:e.jsx($,{className:"w-3.5 h-3.5"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsx(q,{variant:G[s.status]||"neutral",size:"sm",children:s.prospect_trade_type}),s.estimated_mrr&&e.jsxs("span",{className:"text-xs font-mono font-medium text-emerald-600",children:["$",s.estimated_mrr]})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:s.created_at?new Date(s.created_at).toLocaleDateString([],{month:"short",day:"numeric"}):""})]},s.id))})]},c)})})}function ae({prospects:a,onEdit:d,onDelete:r,onConvert:n,canConvert:l,onStatusChange:c}){const x=[{key:"prospect_name",label:"Name",render:s=>e.jsx("span",{className:"font-medium text-gray-900",children:s})},{key:"prospect_company",label:"Company",render:s=>e.jsx("span",{className:"text-gray-500",children:s||"—"})},{key:"prospect_trade_type",label:"Trade",render:s=>e.jsx("span",{className:"text-gray-500 capitalize",children:s})},{key:"status",label:"Status",render:(s,o)=>e.jsx("select",{value:s,onChange:m=>{m.stopPropagation(),c(o.id,m.target.value)},className:"text-xs font-medium px-2 py-0.5 rounded-lg cursor-pointer bg-white border border-gray-200 text-gray-700 focus:border-orange-400 focus:ring-1 focus:ring-orange-100 outline-none",onClick:m=>m.stopPropagation(),children:b.map(m=>e.jsx("option",{value:m,children:v(m)},m))})},{key:"estimated_mrr",label:"Est. MRR",align:"right",render:s=>e.jsx("span",{className:`font-mono ${s?"text-emerald-600":"text-gray-400"}`,children:s?`$${s}`:"—"})},{key:"notes",label:"Notes",render:s=>e.jsx("span",{className:"text-gray-400 truncate max-w-[200px] block",children:s||"—"})},{key:"_actions",label:"",render:(s,o)=>e.jsxs("div",{className:"flex items-center gap-1",onClick:m=>m.stopPropagation(),children:[e.jsx("button",{onClick:()=>d(o),className:"p-1.5 rounded-lg text-gray-400 hover:text-gray-700 hover:bg-gray-100 transition-colors cursor-pointer",children:e.jsx(Y,{className:"w-3.5 h-3.5"})}),l(o)&&e.jsx("button",{onClick:()=>n(o),className:"p-1.5 rounded-lg text-emerald-500 hover:bg-emerald-50 transition-colors cursor-pointer",title:"Convert to client",children:e.jsx(L,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>r(o),className:"p-1.5 rounded-lg text-gray-400 hover:text-red-500 hover:bg-red-50 transition-colors cursor-pointer",title:"Delete prospect",children:e.jsx($,{className:"w-3.5 h-3.5"})})]})}];return e.jsx(J,{columns:x,data:a,emptyMessage:"No prospects yet. Add your first one."})}function re({prospects:a,total:d}){const r=a.reduce((l,c)=>l+(c.estimated_mrr||0),0),n=a.filter(l=>l.status==="won").length;return e.jsx("div",{className:"bg-white border border-gray-200/50 rounded-2xl p-5 shadow-card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pipeline"}),e.jsxs("span",{className:"text-xs font-mono text-gray-500",children:[d," prospects"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-xs text-gray-400",children:["Est. value: ",e.jsxs("span",{className:"font-mono font-medium text-emerald-600",children:["$",r.toLocaleString()]}),"/mo"]}),e.jsxs("span",{className:"text-xs text-gray-400",children:["Won: ",e.jsx("span",{className:"font-mono font-medium text-emerald-600",children:n})]})]})]})})}const F={prospect_name:"",prospect_company:"",prospect_email:"",prospect_phone:"",prospect_trade_type:"hvac",status:"cold",notes:"",estimated_mrr:""};function he(){const[a,d]=p.useState([]),[r,n]=p.useState(0),[l,c]=p.useState(1),[x,s]=p.useState(1),[o,m]=p.useState(""),[j,w]=p.useState(!0),[T,M]=p.useState("board"),[U,_]=p.useState(!1),[k,A]=p.useState(null),[f,u]=p.useState(null),[N,C]=p.useState({...F}),g=async()=>{try{const t={page:l,per_page:50};o&&(t.status=o);const i=await h.getAdminOutreach(t);d(i.prospects||[]),n(i.total||0),s(i.pages||1)}catch(t){console.error("Failed to fetch outreach:",t)}finally{w(!1)}};p.useEffect(()=>{g()},[l,o]);const S=()=>{C({...F}),_(!1),A(null)},R=async()=>{try{const t={...N,estimated_mrr:N.estimated_mrr?Number(N.estimated_mrr):null};k?await h.updateOutreach(k,t):await h.createOutreach(t),S(),g()}catch(t){console.error("Failed to save prospect:",t)}},E=t=>{var i;C({prospect_name:t.prospect_name||"",prospect_company:t.prospect_company||"",prospect_email:t.prospect_email||"",prospect_phone:t.prospect_phone||"",prospect_trade_type:t.prospect_trade_type||"hvac",status:t.status||"cold",notes:t.notes||"",estimated_mrr:((i=t.estimated_mrr)==null?void 0:i.toString())||""}),A(t.id),_(!0)},z=async(t,i)=>{try{await h.updateOutreach(t,{status:i}),g()}catch(P){console.error("Failed to update status:",P)}},I=async t=>{try{await h.deleteOutreach(t.id),u(null),g()}catch(i){console.error("Failed to delete prospect:",i)}},V=async t=>{try{await h.convertOutreach(t.id),u(null),g()}catch(i){console.error("Failed to convert prospect:",i)}},D=t=>["won","proposal_sent"].includes(t.status)&&!t.converted_client_id,B=b.reduce((t,i)=>(t[i]=a.filter(P=>P.status===i),t),{});return e.jsxs("div",{className:"min-h-screen bg-[#FAFAFA]",children:[e.jsx(W,{title:"Sales Outreach",actions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex gap-1 bg-gray-100 rounded-xl p-0.5",children:Z.map(t=>e.jsx("button",{onClick:()=>M(t),className:`px-3 py-1.5 text-xs font-medium rounded-lg capitalize transition-all cursor-pointer ${T===t?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:t},t))}),e.jsxs("button",{onClick:()=>{S(),_(!0)},className:"flex items-center gap-1.5 px-4 py-2 rounded-xl text-sm font-medium text-white bg-orange-500 hover:bg-orange-600 transition-colors cursor-pointer",children:[e.jsx(X,{className:"w-4 h-4"}),"New Prospect"]})]})}),e.jsx(ee,{action:f,onCancel:()=>u(null),onConfirm:()=>f.type==="delete"?I(f.prospect):V(f.prospect)}),e.jsx(te,{show:U,editingId:k,form:N,onFormChange:C,onSave:R,onClose:S}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:o,onChange:t=>{m(t.target.value),c(1)},className:`px-3 py-2 rounded-xl text-sm cursor-pointer ${y}`,children:[e.jsx("option",{value:"",children:"All Statuses"}),b.map(t=>e.jsx("option",{value:t,children:v(t)},t))]}),e.jsxs("span",{className:"text-xs font-mono text-gray-400",children:[r," prospects"]})]}),x>1&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{disabled:l<=1,onClick:()=>c(t=>t-1),className:"px-3 py-1.5 text-xs font-medium rounded-xl bg-white border border-gray-200 text-gray-600 hover:border-gray-300 disabled:opacity-40 cursor-pointer transition-colors",children:"Prev"}),e.jsxs("span",{className:"px-2.5 py-1.5 text-xs font-mono text-gray-500",children:[l," / ",x]}),e.jsx("button",{disabled:l>=x,onClick:()=>c(t=>t+1),className:"px-3 py-1.5 text-xs font-medium rounded-xl bg-white border border-gray-200 text-gray-600 hover:border-gray-300 disabled:opacity-40 cursor-pointer transition-colors",children:"Next"})]})]}),j?e.jsx("div",{className:"h-64 bg-gray-100 rounded-2xl animate-pulse"}):T==="board"?e.jsx(se,{grouped:B,onEdit:E,onDelete:t=>u({type:"delete",prospect:t}),onConvert:t=>u({type:"convert",prospect:t}),canConvert:D}):e.jsx(ae,{prospects:a,onEdit:E,onDelete:t=>u({type:"delete",prospect:t}),onConvert:t=>u({type:"convert",prospect:t}),canConvert:D,onStatusChange:z}),!j&&a.length>0&&e.jsx("div",{className:"mt-5",children:e.jsx(re,{prospects:a,total:r})})]})}export{he as default};
