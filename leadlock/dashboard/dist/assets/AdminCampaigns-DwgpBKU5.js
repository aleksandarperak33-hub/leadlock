import{u as _,r as x,j as e,S as b,X as y,h as j}from"./index-BHeaMpcx.js";import{a as u}from"./client-CM7usSQg.js";import{P as k}from"./PageHeader-B70tmnmd.js";import{B as S}from"./Badge-CMg_OOW7.js";import{E as F}from"./EmptyState-OQFNGUqU.js";import{P as h}from"./plus-uTLkigTW.js";import{P as A}from"./pause-DIl1IL8D.js";import{P}from"./play-PIJ_1fDL.js";const R={draft:"neutral",active:"success",paused:"warning",completed:"neutral"},N=[{step:1,channel:"email",delay_hours:0},{step:2,channel:"email",delay_hours:48},{step:3,channel:"email",delay_hours:96}],f={name:"",description:"",target_trades:[],target_locations:[],daily_limit:25,sequence_steps:N};function q({campaign:t,onToggle:i,onClick:m}){const n=t.total_sent??0,o=t.total_opened??0,l=t.total_replied??0,c=n>0?(o/n*100).toFixed(1):"0.0",s=n>0?(l/n*100).toFixed(1):"0.0";return e.jsxs("div",{onClick:m,className:"bg-white border border-gray-200/50 rounded-2xl p-6 hover:shadow-md transition-shadow cursor-pointer",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2.5 mb-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:t.name}),e.jsx(S,{variant:R[t.status]||"neutral",children:t.status})]}),t.description&&e.jsx("p",{className:"text-sm text-gray-500 line-clamp-2",children:t.description})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4 shrink-0",children:[e.jsx("button",{onClick:a=>{a.stopPropagation(),i(t)},className:"p-2 rounded-xl bg-white border border-gray-200/50 hover:bg-gray-50 transition-colors cursor-pointer",children:t.status==="active"?e.jsx(A,{className:"w-4 h-4 text-amber-500"}):e.jsx(P,{className:"w-4 h-4 text-emerald-500"})}),e.jsx(j,{className:"w-4 h-4 text-gray-300"})]})]}),e.jsxs("div",{className:"flex items-center gap-6 pt-3 border-t border-gray-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prospects"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 font-mono mt-0.5",children:t.prospect_count||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sent"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 font-mono mt-0.5",children:n})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Open Rate"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 font-mono mt-0.5",children:[c,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reply Rate"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 font-mono mt-0.5",children:[s,"%"]})]})]})]})}function E({form:t,onChange:i,onSubmit:m,onClose:n}){const o=(s,a)=>i({...t,[s]:a}),l=()=>{const s={step:t.sequence_steps.length+1,channel:"email",delay_hours:t.sequence_steps.length===0?0:48};o("sequence_steps",[...t.sequence_steps,s])},c=s=>{const a=t.sequence_steps.filter((p,d)=>d!==s).map((p,d)=>({...p,step:d+1}));o("sequence_steps",a)};return e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200/50",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Create Campaign"}),e.jsx("button",{onClick:n,className:"p-1.5 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:e.jsx(y,{className:"w-4 h-4 text-gray-400"})})]}),e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-1.5",children:"Campaign Name"}),e.jsx("input",{type:"text",value:t.name,onChange:s=>o("name",s.target.value),className:"w-full px-3 py-2.5 bg-white border border-gray-200 rounded-xl text-sm text-gray-900 placeholder:text-gray-400 outline-none focus:border-orange-500 focus:ring-2 focus:ring-orange-100 transition-shadow",placeholder:"Q1 HVAC Outreach"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-1.5",children:"Description"}),e.jsx("textarea",{value:t.description,onChange:s=>o("description",s.target.value),className:"w-full px-3 py-2.5 bg-white border border-gray-200 rounded-xl text-sm text-gray-900 placeholder:text-gray-400 outline-none focus:border-orange-500 focus:ring-2 focus:ring-orange-100 transition-shadow h-20 resize-none",placeholder:"Campaign description..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-1.5",children:"Daily Limit"}),e.jsx("input",{type:"number",value:t.daily_limit,onChange:s=>o("daily_limit",parseInt(s.target.value)||0),className:"w-full px-3 py-2.5 bg-white border border-gray-200 rounded-xl text-sm text-gray-900 outline-none focus:border-orange-500 focus:ring-2 focus:ring-orange-100 transition-shadow font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-2",children:"Sequence Steps"}),e.jsx("div",{className:"space-y-2",children:t.sequence_steps.map((s,a)=>e.jsxs("div",{className:"flex items-center gap-3 bg-gray-50/80 border border-gray-100 rounded-xl p-3",children:[e.jsx("span",{className:"text-xs font-bold text-orange-500 font-mono",children:s.step}),e.jsx(j,{className:"w-3 h-3 text-gray-300"}),e.jsx("span",{className:"text-xs capitalize text-gray-700",children:s.channel}),e.jsxs("span",{className:"text-xs text-gray-400",children:["after ",s.delay_hours,"h"]}),e.jsx("div",{className:"flex-1"}),e.jsx("button",{onClick:()=>c(a),className:"p-1 rounded-lg hover:bg-red-50 transition-colors cursor-pointer",children:e.jsx(y,{className:"w-3.5 h-3.5 text-gray-400 hover:text-red-500"})})]},a))}),e.jsxs("button",{onClick:l,className:"flex items-center gap-1.5 mt-2 px-3 py-1.5 rounded-lg text-xs font-medium text-gray-500 border border-gray-200 border-dashed hover:border-orange-300 hover:text-orange-600 transition-colors cursor-pointer",children:[e.jsx(h,{className:"w-3.5 h-3.5"})," Add Step"]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 px-6 py-4 border-t border-gray-200/50",children:[e.jsx("button",{onClick:n,className:"px-4 py-2 rounded-xl text-sm font-medium text-gray-500 bg-white border border-gray-200 hover:bg-gray-50 transition-colors cursor-pointer",children:"Cancel"}),e.jsx("button",{onClick:m,disabled:!t.name,className:"px-4 py-2 rounded-xl text-sm font-medium text-white bg-orange-500 hover:bg-orange-600 disabled:opacity-50 transition-colors cursor-pointer",children:"Create"})]})]})})}function H(){const t=_(),[i,m]=x.useState([]),[n,o]=x.useState(!0),[l,c]=x.useState(null),[s,a]=x.useState(!1),[p,d]=x.useState(f);x.useEffect(()=>{g()},[]);const g=async()=>{try{c(null);const r=await u.getCampaigns();m(r.campaigns||[])}catch{c("Failed to load campaigns.")}finally{o(!1)}},v=async()=>{try{await u.createCampaign(p),a(!1),d({...f,sequence_steps:N}),g()}catch(r){console.error("Failed to create campaign:",r)}},w=async r=>{try{r.status==="active"?await u.pauseCampaign(r.id):await u.resumeCampaign(r.id),g()}catch(C){console.error("Failed to toggle campaign:",C)}};return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-6 h-6 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"min-h-screen bg-[#FAFAFA]",children:[e.jsx(k,{title:"Campaigns",subtitle:`${i.length} campaign${i.length!==1?"s":""}`,actions:e.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-medium text-white bg-orange-500 hover:bg-orange-600 transition-colors cursor-pointer",children:[e.jsx(h,{className:"w-4 h-4"})," New Campaign"]})}),l&&e.jsxs("div",{className:"mb-4 flex items-center gap-3 px-4 py-3 rounded-xl bg-red-50 border border-red-200/60",children:[e.jsx(b,{className:"w-4 h-4 text-red-500 shrink-0"}),e.jsx("p",{className:"text-sm text-red-700 flex-1",children:l}),e.jsx("button",{onClick:g,className:"text-xs font-medium text-red-600 hover:text-red-800 cursor-pointer",children:"Retry"})]}),s&&e.jsx(E,{form:p,onChange:d,onSubmit:v,onClose:()=>a(!1)}),i.length===0?e.jsx("div",{className:"bg-white border border-gray-200/50 rounded-2xl shadow-card",children:e.jsx(F,{icon:b,title:"No campaigns yet",description:"Create your first campaign to start automated outreach.",action:e.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-medium text-white bg-orange-500 hover:bg-orange-600 transition-colors cursor-pointer",children:[e.jsx(h,{className:"w-4 h-4"})," Create Campaign"]})})}):e.jsx("div",{className:"space-y-4",children:i.map(r=>e.jsx(q,{campaign:r,onToggle:w,onClick:()=>t(`/campaigns/${r.id}`)},r.id))})]})}export{H as default};
