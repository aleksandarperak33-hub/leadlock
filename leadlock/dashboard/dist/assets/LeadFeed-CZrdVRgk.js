import{u as _,r as t,P as k,j as e,L as E,a as w}from"./index-BHeaMpcx.js";import{a as P}from"./client-CM7usSQg.js";import{a as v}from"./response-time-BTWFT0BV.js";import{u as A}from"./useDebounce-Zn-qPrUU.js";import{P as D}from"./PageHeader-B70tmnmd.js";import{S as C}from"./SearchInput-Cd1-TkF5.js";import{T}from"./Tabs-D_nwivGe.js";import{D as F}from"./DataTable-2VHuwdQk.js";import{L as I}from"./LeadStatusBadge-VUFrpEHV.js";import{P as R}from"./Pagination-6EHWqcmv.js";import{C as $}from"./clock-YShVbrww.js";import"./search-DnPY5eD6.js";import"./chevron-down-BThlQuyw.js";import"./chevron-up-B8rptYAu.js";import"./Badge-CMg_OOW7.js";const B=()=>[{key:"name",label:"Name",render:(s,r)=>e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[r.first_name||"Unknown"," ",r.last_name||""]})},{key:"phone_masked",label:"Phone",render:s=>e.jsx("span",{className:"text-xs font-mono text-gray-500",children:s})},{key:"source",label:"Source",render:s=>e.jsx("span",{className:"text-xs text-gray-500 capitalize",children:s==null?void 0:s.replaceAll("_"," ")})},{key:"state",label:"Status",render:s=>e.jsx(I,{status:s})},{key:"score",label:"Score",render:s=>s==null?e.jsx("span",{className:"text-xs text-gray-400",children:"—"}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-12 h-1.5 rounded-full bg-gray-100 overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${s}%`,background:s>=70?"#10b981":s>=40?"#f59e0b":"#ef4444"}})}),e.jsx("span",{className:"text-xs font-mono text-gray-500",children:s})]})},{key:"first_response_ms",label:"Response",render:s=>s?e.jsxs("span",{className:`text-xs font-mono font-medium flex items-center gap-1 ${v(s)}`,children:[e.jsx($,{className:"w-3 h-3"}),(s/1e3).toFixed(1),"s"]}):e.jsx("span",{className:"text-xs text-gray-400",children:"—"})},{key:"created_at",label:"Date",render:s=>e.jsx("span",{className:"text-xs font-mono text-gray-400",children:s?new Date(s).toLocaleDateString():"—"})}];function ee(){const s=_(),[r,p]=t.useState([]),[h,g]=t.useState(0),[l,c]=t.useState(1),[u,f]=t.useState(1),[o,y]=t.useState("all"),[i,b]=t.useState(""),d=A(i,300),[j,m]=t.useState(!0),x=async()=>{try{const a={page:l,per_page:w.LEADS};o!=="all"&&(a.state=o),d&&(a.search=d);const n=await P.getLeads(a);p(n.leads||[]),g(n.total||0),f(n.pages||1)}catch(a){console.error("Failed to fetch leads:",a)}finally{m(!1)}};t.useEffect(()=>{m(!0),x();const a=setInterval(x,k.LEAD_FEED);return()=>clearInterval(a)},[l,o,d]);const N=a=>{b(a),c(1)},S=a=>{y(a),c(1)},L=e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-xs font-mono text-gray-400 bg-gray-50 border border-gray-200/50 px-2.5 py-1 rounded-lg",children:[h," total"]}),e.jsx("div",{className:"w-64",children:e.jsx(C,{value:i,onChange:N,placeholder:"Search name, phone, service..."})})]});return e.jsxs("div",{className:"space-y-0",children:[e.jsx(D,{title:"Leads",actions:L}),e.jsx(T,{tabs:E,activeId:o,onChange:S}),j&&r.length===0?e.jsx("div",{className:"bg-white border border-gray-200/50 rounded-2xl shadow-card overflow-hidden",children:[...Array(5)].map((a,n)=>e.jsx("div",{className:"px-4 py-4 border-b border-gray-100 last:border-0",children:e.jsx("div",{className:"h-4 bg-gray-100 rounded-lg animate-pulse"})},n))}):e.jsx(F,{columns:B(),data:r,emptyMessage:"No leads found",onRowClick:a=>s(`/conversations/${a.id}`)}),e.jsx(R,{page:l,pages:u,onChange:c})]})}export{ee as default};
