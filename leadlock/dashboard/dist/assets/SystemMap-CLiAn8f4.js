import{r as o,j as e,U as _,p as h,C as w,Z as k,M as C,f as S,S as A}from"./index-BHeaMpcx.js";import{a as R}from"./client-CM7usSQg.js";import{T as E}from"./target-CLAK157J.js";import{S as f}from"./search-DnPY5eD6.js";import{T as I}from"./trending-up-DpDefieV.js";import{H as y,B as b,G as M,R as T,a as L,S as P}from"./AdminAgents-D9GV5Wee.js";import{F}from"./flask-conical-Brt26av9.js";import{A as j}from"./activity-DbAn3e2R.js";import"./PageHeader-B70tmnmd.js";import"./Tabs-D_nwivGe.js";import"./pause-DIl1IL8D.js";import"./trash-2-BHMdR2CX.js";import"./sparkles-DMW9fElz.js";import"./chevron-down-BThlQuyw.js";import"./generateCategoricalChart-AG-GDjTD.js";import"./AreaChart-DtmJbnjX.js";import"./circle-alert-CrLVGEbj.js";const q=3e4;function O(){const[t,s]=o.useState(null),[a,n]=o.useState(!0),[l,r]=o.useState(null),i=o.useRef(null),d=o.useRef(!0),x=o.useCallback(async()=>{try{const c=await R.getSystemMap();s(c.data),r(null)}catch(c){r(c.message||"Failed to load system map")}finally{d.current&&(n(!1),d.current=!1)}},[]);return o.useEffect(()=>(x(),i.current=setInterval(x,q),()=>clearInterval(i.current)),[x]),{data:t,loading:a,error:l}}const B={send:A,search:f,cog:P,activity:j,"heart-pulse":y,"rotate-cw":L,shield:S,"flask-conical":F,brain:b,"refresh-cw":T,gift:M,mail:h},N={sky:"#0ea5e9",lime:"#84cc16",orange:"#f97316",cyan:"#06b6d4",gray:"#6b7280",green:"#22c55e",emerald:"#10b981",stone:"#78716c",violet:"#8b5cf6",red:"#ef4444",purple:"#a855f7",amber:"#f59e0b",indigo:"#6366f1",pink:"#ec4899"},G={scraper:{display_name:"Prospect Scraper",icon:"search",color:"cyan"},outreach_sequencer:{display_name:"Outreach Sequencer",icon:"mail",color:"red"},ab_test_engine:{display_name:"A/B Testing",icon:"flask-conical",color:"purple"},winback_agent:{display_name:"Win-Back Agent",icon:"refresh-cw",color:"amber"},reflection_agent:{display_name:"Reflection Agent",icon:"brain",color:"indigo"},outreach_monitor:{display_name:"Outreach Monitor",icon:"heart-pulse",color:"emerald"},referral_agent:{display_name:"Referral Agent",icon:"gift",color:"pink"}},H=[{id:"discovery",label:"Discovery",icon:f,color:"cyan",description:"Find prospects",agents:["scraper"],metrics:[{key:"cold",label:"New / Cold",source:"prospect"}]},{id:"outreach",label:"Outreach",icon:h,color:"red",description:"Email sequences",agents:["outreach_sequencer","ab_test_engine"],metrics:[{key:"contacted",label:"In Sequence",source:"prospect"},{key:"emails_sent_today",label:"Emails Today",source:"top"}]},{id:"engagement",label:"Engagement",icon:C,color:"purple",description:"Replies & demos",agents:["winback_agent","referral_agent"],metrics:[{key:"demo_scheduled",label:"Demos Scheduled",source:"prospect"},{key:"demo_completed",label:"Demos Done",source:"prospect"},{key:"emails_replied_today",label:"Replies Today",source:"top"}]},{id:"conversion",label:"Conversion",icon:I,color:"green",description:"Close deals",agents:[],metrics:[{key:"proposal_sent",label:"Proposals Sent",source:"prospect"},{key:"won",label:"Won",source:"prospect"},{key:"lost",label:"Lost",source:"prospect"}]}];function U({value:t,highlight:s}){const a=s?"bg-green-100 text-green-800":"bg-gray-100 text-gray-700";return e.jsx("span",{className:`inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-[11px] font-semibold rounded-full font-mono ${a}`,children:t??0})}function g({name:t,onClick:s}){const a=G[t]||{},n=B[a.icon]||j,l=N[a.color]||"#6b7280";return e.jsxs("button",{type:"button",onClick:()=>s==null?void 0:s(t),className:"flex items-center gap-1.5 px-2 py-1 rounded-lg text-xs font-medium bg-white border border-gray-200 hover:border-gray-300 hover:shadow-sm transition-all cursor-pointer group",children:[e.jsx(n,{className:"w-3.5 h-3.5 shrink-0",style:{color:l}}),e.jsx("span",{className:"text-gray-700 group-hover:text-gray-900",children:a.display_name||t})]})}function $(){return e.jsx("div",{className:"hidden lg:flex items-center px-1 shrink-0",children:e.jsx("div",{className:"w-8 h-px bg-gradient-to-r from-gray-300 to-gray-200 relative",children:e.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 w-0 h-0 border-t-[4px] border-b-[4px] border-l-[6px] border-transparent border-l-gray-300"})})})}function W({stage:t,mapData:s,onAgentClick:a}){const n=(s==null?void 0:s.prospect_counts)||{},l=t.icon;return e.jsxs("div",{className:"glass-card p-4 flex-1 min-w-[170px]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:`w-7 h-7 rounded-lg bg-${t.color}-50 flex items-center justify-center`,children:e.jsx(l,{className:"w-4 h-4",style:{color:N[t.color]}})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-900 uppercase tracking-wider",children:t.label}),e.jsx("p",{className:"text-[10px] text-gray-400",children:t.description})]})]}),e.jsx("div",{className:"space-y-1.5 mb-3",children:t.metrics.map(r=>{const i=r.source==="prospect"?n[r.key]??0:(s==null?void 0:s[r.key])??0,d=r.key==="won";return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:r.label}),e.jsx(U,{value:i,highlight:d})]},r.key)})}),t.agents.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5 pt-2 border-t border-gray-100",children:t.agents.map(r=>e.jsx(g,{name:r,onClick:a},r))})]})}function oe({onSelectAgent:t}){const{data:s,loading:a,error:n}=O(),l=m=>{t==null||t(m)};if(a)return e.jsxs("div",{className:"space-y-4 animate-pulse",children:[e.jsx("div",{className:"h-16 bg-gray-100 rounded-xl"}),e.jsx("div",{className:"flex gap-4",children:[...Array(4)].map((m,p)=>e.jsx("div",{className:"h-52 flex-1 bg-gray-100 rounded-xl"},`skel-${p}`))}),e.jsx("div",{className:"h-20 bg-gray-100 rounded-xl"})]});if(n)return e.jsx("div",{className:"glass-card p-6 text-center",children:e.jsx("p",{className:"text-sm text-red-600 mb-2",children:n})});const r=(s==null?void 0:s.prospect_counts)||{},i=(s==null?void 0:s.campaign_counts)||{},d=(s==null?void 0:s.total_prospects)??0,x=i.active??0,c=r.won??0,u=r.lost??0,v=c+u>0?(c/(c+u)*100).toFixed(1):"0.0";return e.jsxs("div",{className:"animate-fade-up space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-6 px-4 py-3 bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl border border-orange-100",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("span",{className:"font-semibold text-gray-900 text-lg font-mono mr-1",children:d}),"prospects"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("span",{className:"font-semibold text-gray-900 text-lg font-mono mr-1",children:x}),"active campaigns"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("span",{className:"font-semibold text-gray-900 text-lg font-mono mr-1",children:(s==null?void 0:s.emails_sent_today)??0}),"emails today"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("span",{className:"font-semibold text-gray-900 text-lg font-mono mr-1",children:(s==null?void 0:s.emails_opened_today)??0}),"opened today"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("span",{className:"font-semibold text-green-700 text-lg font-mono mr-1",children:c}),"won",e.jsxs("span",{className:"text-gray-400 ml-1",children:["(",v,"%)"]})]})]})]}),e.jsx("div",{className:"flex flex-col lg:flex-row items-stretch gap-2",children:H.map((m,p)=>e.jsxs("div",{className:"flex items-stretch flex-1 min-w-0",children:[p>0&&e.jsx($,{}),e.jsx(W,{stage:m,mapData:s,onAgentClick:l})]},m.id))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"glass-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(y,{className:"w-4 h-4 text-emerald-500"}),e.jsx("h4",{className:"text-xs font-bold text-gray-900 uppercase tracking-wider",children:"Pipeline Health"})]}),e.jsx("p",{className:"text-[11px] text-gray-400 mb-3",children:"Anomaly detection, sequence cleanup, deliverability"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:e.jsx(g,{name:"outreach_monitor",onClick:l})})]}),e.jsxs("div",{className:"glass-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(b,{className:"w-4 h-4 text-indigo-500"}),e.jsx("h4",{className:"text-xs font-bold text-gray-900 uppercase tracking-wider",children:"Intelligence"})]}),e.jsxs("p",{className:"text-[11px] text-gray-400 mb-3",children:["Daily audit, A/B optimization",(s==null?void 0:s.ab_tests_today)>0&&e.jsxs("span",{className:"ml-2 text-purple-600 font-medium",children:[s.ab_tests_today," tests today"]})]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:e.jsx(g,{name:"reflection_agent",onClick:l})})]})]})]})}export{oe as default};
