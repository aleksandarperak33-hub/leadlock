import{r,j as e,D as A,d as w}from"./index-BHeaMpcx.js";import{a as C}from"./client-CM7usSQg.js";import{S as c}from"./StatCard-CoJTE6us.js";import{T as R}from"./trending-up-DpDefieV.js";import{R as L,X as T,Y as $,T as E,F as O}from"./generateCategoricalChart-AG-GDjTD.js";import{A as D,a as F}from"./AreaChart-DtmJbnjX.js";const P=["7d","30d","90d"],i={outreach_sequencer:"#ef4444",ab_test_engine:"#a855f7",winback_agent:"#f59e0b",reflection_agent:"#6366f1",referral_agent:"#ec4899",sms_dispatch:"#0ea5e9",lead_state_manager:"#84cc16",crm_sync:"#f97316",scraper:"#06b6d4",task_processor:"#6b7280",system_health:"#22c55e",outreach_monitor:"#10b981",retry_worker:"#78716c",registration_poller:"#8b5cf6"},d={outreach_sequencer:"Sequencer",ab_test_engine:"A/B Testing",winback_agent:"Win-Back",reflection_agent:"Reflection",referral_agent:"Referral",sms_dispatch:"SMS Dispatch",lead_state_manager:"Lead State",crm_sync:"CRM Sync",scraper:"Scraper",task_processor:"Tasks",system_health:"Sys Health",outreach_monitor:"Outreach Mon",retry_worker:"Retry",registration_poller:"A2P Reg"};function I(){var h,p,u;const[n,y]=r.useState("7d"),[a,j]=r.useState(null),[b,x]=r.useState(!0),[m,g]=r.useState(null),o=r.useCallback(()=>{x(!0),g(null),C.getAgentCosts(n).then(t=>{j(t.data)}).catch(t=>{g(t.message)}).finally(()=>{x(!1)})},[n]);if(r.useEffect(()=>{o()},[o]),b)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-6 h-6 border-2 border-orange-200 border-t-orange-500 rounded-full animate-spin"})});if(m)return e.jsxs("div",{className:"glass-card p-6 text-center",children:[e.jsx("p",{className:"text-red-600 text-sm mb-2",children:m}),e.jsx("button",{onClick:o,className:"text-sm text-orange-600 hover:underline",children:"Retry"})]});if(!a)return null;const f=Object.keys(i),_=(a.daily||[]).map(t=>{var s;return{...t,date:(s=t.date)==null?void 0:s.slice(5)}}),N=f.map(t=>{var s;return{name:t,label:d[t],color:i[t],total:((s=a.agent_totals)==null?void 0:s[t])??0}}).sort((t,s)=>s.total-t.total);return e.jsxs("div",{className:"space-y-6 animate-fade-up",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(c,{label:"TOTAL COST",value:`$${((h=a.grand_total)==null?void 0:h.toFixed(3))??"0.000"}`,icon:A,color:"blue"}),e.jsx(c,{label:"DAILY AVERAGE",value:`$${((p=a.daily_average)==null?void 0:p.toFixed(4))??"0.0000"}`,icon:R,color:"green"}),e.jsx(c,{label:"PROJECTED MONTHLY",value:`$${((u=a.projected_monthly)==null?void 0:u.toFixed(2))??"0.00"}`,icon:w,color:"purple"})]}),e.jsxs("div",{className:"glass-card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Cost by Agent"}),e.jsx("div",{className:"flex gap-1",children:P.map(t=>e.jsx("button",{onClick:()=>y(t),className:`px-3 py-1 text-xs font-medium rounded-lg transition-colors ${n===t?"bg-orange-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:t},t))})]}),e.jsx(L,{width:"100%",height:280,children:e.jsxs(D,{data:_,margin:{top:4,right:4,bottom:0,left:0},children:[e.jsx(T,{dataKey:"date",tick:{fontSize:11,fill:"#9ca3af"},axisLine:!1,tickLine:!1}),e.jsx($,{tick:{fontSize:11,fill:"#9ca3af"},axisLine:!1,tickLine:!1,tickFormatter:t=>`$${t}`,width:50}),e.jsx(E,{formatter:(t,s)=>[`$${Number(t).toFixed(4)}`,d[s]||s],contentStyle:{fontSize:12,borderRadius:8,border:"1px solid #e5e7eb"}}),e.jsx(O,{formatter:t=>d[t]||t,wrapperStyle:{fontSize:11}}),f.map(t=>e.jsx(F,{type:"monotone",dataKey:t,stackId:"cost",stroke:i[t],fill:i[t],fillOpacity:.3},t))]})})]}),e.jsxs("div",{className:"glass-card p-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Per-Agent Breakdown"}),e.jsx("div",{className:"divide-y divide-gray-100",children:N.map(({name:t,label:s,color:S,total:l})=>{const v=a.grand_total>0?l/a.grand_total*100:0,k=a.days>0?l/a.days:0;return e.jsxs("div",{className:"flex items-center justify-between py-2.5",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full",style:{backgroundColor:S}}),e.jsx("span",{className:"text-sm text-gray-700",children:s})]}),e.jsxs("div",{className:"flex items-center gap-6 text-xs text-gray-500",children:[e.jsxs("span",{className:"font-mono w-16 text-right",children:["$",l.toFixed(4)]}),e.jsxs("span",{className:"w-12 text-right",children:[v.toFixed(1),"%"]}),e.jsxs("span",{className:"font-mono w-20 text-right",children:["$",k.toFixed(4),"/d"]})]})]},t)})})]})]})}export{I as default};
