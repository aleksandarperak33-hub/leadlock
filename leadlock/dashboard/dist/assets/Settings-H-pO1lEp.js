import{c as H,j as e,e as L,r as l,f as D,B as q}from"./index-BHeaMpcx.js";import{a as $}from"./client-CM7usSQg.js";import{P as X}from"./PageHeader-B70tmnmd.js";import{P as Y}from"./phone-DNdX0wKk.js";import{L as F}from"./loader-circle-IxmfVIqj.js";import{S as J}from"./search-DnPY5eD6.js";import{C as O}from"./circle-check-CZ_JZGx6.js";import{C as W}from"./circle-x-DCbRSBO6.js";import{C as G}from"./clock-YShVbrww.js";import{P as K}from"./plug-Jek8NuEF.js";import{C as U}from"./circle-alert-CrLVGEbj.js";import{C as V}from"./check-7J3fwmG1.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=H("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);function w({title:s,description:r}){return e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-1",children:s}),r&&e.jsx("p",{className:"text-sm text-gray-500",children:r})]})}function T(){return e.jsx("div",{className:"border-b border-gray-200/50 pb-8 mb-8"})}function Q(s){return{pending:"Not Started",collecting_info:"Info Needed",profile_pending:"In Review",profile_approved:"In Review",profile_rejected:"Action Required",brand_pending:"In Review",brand_approved:"Almost Ready",brand_rejected:"Action Required",campaign_pending:"Almost Ready",campaign_rejected:"Action Required",tf_verification_pending:"In Review",tf_rejected:"Action Required",active:"Active"}[s]||s||"Not Started"}function ee({settings:s}){const r=[{label:"Business Name",value:s==null?void 0:s.business_name},{label:"Trade Type",value:s==null?void 0:s.trade_type,capitalize:!0},{label:"Twilio Number",value:(s==null?void 0:s.twilio_phone)||"Not assigned"},{label:"Registration",value:Q(s==null?void 0:s.ten_dlc_status),capitalize:!0}];return e.jsxs("div",{children:[e.jsx(w,{title:"Business Information",description:"Read-only details about your account."}),e.jsx("div",{className:"bg-gray-50 border border-gray-200/50 rounded-xl p-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-5",children:r.map(({label:a,value:i,capitalize:n})=>e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-400",children:a}),e.jsx("p",{className:`text-sm mt-0.5 font-medium text-gray-900 ${n?"capitalize":""}`,children:i||"â€”"})]},a))})})]})}const m="w-full px-4 py-2.5 text-sm bg-white border border-gray-200 rounded-xl outline-none focus:border-orange-300 focus:ring-2 focus:ring-orange-100 placeholder:text-gray-400 text-gray-900 transition-all",y="text-sm font-medium text-gray-700 mb-1.5 block",se=[{value:"friendly_professional",label:"Friendly Professional"},{value:"casual",label:"Casual"},{value:"formal",label:"Formal"}],ae=[{value:"ai_responds_books_next_available",label:"AI responds, books next available"},{value:"ai_responds_owner_notified",label:"AI responds, owner notified"},{value:"do_not_respond",label:"Do not respond until business hours"}],te=[{value:"servicetitan",label:"ServiceTitan"},{value:"housecallpro",label:"Housecall Pro"},{value:"jobber",label:"Jobber"},{value:"gohighlevel",label:"GoHighLevel"},{value:"google_sheets",label:"Google Sheets"}],re=[{value:"sole_proprietorship",label:"Sole Proprietorship"},{value:"llc",label:"LLC"},{value:"corporation",label:"Corporation"},{value:"partnership",label:"Partnership"}];function ne({settings:s,onProvisioned:r}){const{token:a}=L(),[i,n]=l.useState(""),[p,o]=l.useState([]),[h,b]=l.useState(!1),[f,N]=l.useState(""),[j,u]=l.useState("");if(s!=null&&s.twilio_phone)return e.jsxs("div",{children:[e.jsx(w,{title:"Phone Number",description:"Your dedicated SMS line."}),e.jsxs("div",{className:"bg-green-50 border border-green-200/60 rounded-xl p-4 flex items-center gap-3",children:[e.jsx(Y,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:s.twilio_phone}),e.jsx("p",{className:"text-xs text-green-600",children:"Active and receiving leads"})]})]})]});const g=async()=>{var c;if(!(!i||i.length!==3)){b(!0),u(""),o([]);try{const t=await fetch(`/api/v1/settings/available-numbers?area_code=${i}`,{headers:{Authorization:`Bearer ${a}`}}),x=await t.json();if(!t.ok)throw new Error(x.detail||"Search failed");o(x.numbers||[]),(c=x.numbers)!=null&&c.length||u("No numbers available for this area code")}catch(t){u(t.message)}finally{b(!1)}}},S=async c=>{N(c),u("");try{const t=await fetch("/api/v1/settings/provision-number",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({phone_number:c})}),x=await t.json();if(!t.ok)throw new Error(x.detail||"Provisioning failed");r(x.phone_number,x)}catch(t){u(t.message)}finally{N("")}};return e.jsxs("div",{children:[e.jsx(w,{title:"Phone Number",description:"Get a dedicated SMS line for your business."}),e.jsxs("div",{className:"flex gap-3 mb-4",children:[e.jsx("input",{id:"area-code",type:"text",value:i,onChange:c=>n(c.target.value.replace(/\D/g,"").slice(0,3)),placeholder:"Area code (e.g. 512)",className:`${m} max-w-[160px]`}),e.jsxs("button",{onClick:g,disabled:h||i.length!==3,className:"flex items-center gap-2 px-5 py-2.5 rounded-xl text-sm font-medium bg-orange-500 hover:bg-orange-600 text-white disabled:opacity-50 transition-colors cursor-pointer",children:[h?e.jsx(F,{className:"w-4 h-4 animate-spin"}):e.jsx(J,{className:"w-4 h-4"}),"Search"]})]}),j&&e.jsx("div",{className:"mb-4 px-4 py-2 rounded-lg bg-red-50 border border-red-200/60 text-red-600 text-sm",children:j}),p.length>0&&e.jsx("div",{className:"space-y-2",children:p.map(c=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 border border-gray-200/50 rounded-xl",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:c.friendly_name}),e.jsxs("p",{className:"text-xs text-gray-400",children:[c.locality,", ",c.region]})]}),e.jsx("button",{onClick:()=>S(c.phone_number),disabled:!!f,className:"px-4 py-2 rounded-lg text-xs font-semibold bg-orange-500 hover:bg-orange-600 text-white disabled:opacity-50 transition-colors cursor-pointer",children:f===c.phone_number?"Provisioning...":"Select"})]},c.phone_number))})]})}function ie({settings:s,setSettings:r}){var I,_,k,P;const{token:a}=L(),[i,n]=l.useState((s==null?void 0:s.business_type)||""),[p,o]=l.useState((s==null?void 0:s.business_ein)||""),[h,b]=l.useState((s==null?void 0:s.business_website)||""),[f,N]=l.useState(((I=s==null?void 0:s.business_address)==null?void 0:I.street)||""),[j,u]=l.useState(((_=s==null?void 0:s.business_address)==null?void 0:_.city)||""),[g,S]=l.useState(((k=s==null?void 0:s.business_address)==null?void 0:k.state)||""),[c,t]=l.useState(((P=s==null?void 0:s.business_address)==null?void 0:P.zip)||""),[x,B]=l.useState(!1),[E,R]=l.useState(""),[C,v]=l.useState(!1),A=async()=>{if(!i){R("Business type is required");return}B(!0),R("");try{const d=await fetch("/api/v1/settings/business-registration",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({business_type:i,business_ein:p,business_website:h,business_address:{street:f,city:j,state:g,zip:c}})}),M=await d.json();if(!d.ok)throw new Error(M.detail||"Registration failed");v(!0),r(z=>({...z,ten_dlc_status:M.status,business_type:i,business_ein:p,business_website:h,business_address:{street:f,city:j,state:g,zip:c}}))}catch(d){R(d.message)}finally{B(!1)}};return C?e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-green-50 border border-green-200/60",children:[e.jsx(O,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Registration Submitted"}),e.jsx("p",{className:"text-xs text-green-600",children:"Your business info has been submitted for review. This typically takes 1-3 business days."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"business-type",className:y,children:"Business Type *"}),e.jsxs("select",{id:"business-type",value:i,onChange:d=>n(d.target.value),className:`${m} cursor-pointer`,children:[e.jsx("option",{value:"",children:"Select business type..."}),re.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"business-ein",className:y,children:["EIN / Tax ID ",i==="sole_proprietorship"?"(optional)":""]}),e.jsx("input",{id:"business-ein",type:"text",value:p,onChange:d=>o(d.target.value.replace(/[^\d-]/g,"").slice(0,11)),className:m,placeholder:"XX-XXXXXXX"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"business-website",className:y,children:"Business Website"}),e.jsx("input",{id:"business-website",type:"url",value:h,onChange:d=>b(d.target.value),className:m,placeholder:"https://yourcompany.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"business-street",className:y,children:"Business Address"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{id:"business-street",type:"text",value:f,onChange:d=>N(d.target.value),className:m,placeholder:"Street address"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("input",{id:"business-city",type:"text",value:j,onChange:d=>u(d.target.value),className:m,placeholder:"City"}),e.jsx("input",{id:"business-state",type:"text",value:g,onChange:d=>S(d.target.value.toUpperCase().slice(0,2)),className:m,placeholder:"State"}),e.jsx("input",{id:"business-zip",type:"text",value:c,onChange:d=>t(d.target.value.replace(/\D/g,"").slice(0,5)),className:m,placeholder:"ZIP"})]})]})]}),E&&e.jsx("div",{className:"px-4 py-2 rounded-lg bg-red-50 border border-red-200/60 text-red-600 text-sm",children:E}),e.jsxs("button",{onClick:A,disabled:x||!i,className:"flex items-center gap-2 px-5 py-2.5 rounded-xl text-sm font-medium bg-orange-500 hover:bg-orange-600 text-white disabled:opacity-50 transition-colors cursor-pointer",children:[x?e.jsx(F,{className:"w-4 h-4 animate-spin"}):e.jsx(D,{className:"w-4 h-4"}),x?"Submitting...":"Submit Registration"]})]})}function le({settings:s,setSettings:r}){const a=(s==null?void 0:s.ten_dlc_status)||"pending",i=a==="collecting_info"&&!(s!=null&&s.business_type);return e.jsxs("div",{children:[e.jsx(w,{title:"SMS Registration",description:"Your number must be registered before it can send outbound SMS."}),e.jsx(oe,{status:a}),i&&e.jsx(ie,{settings:s,setSettings:r})]})}function oe({status:s}){if(s==="active")return e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-green-50 border border-green-200/60",children:[e.jsx(O,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Registration Active"}),e.jsx("p",{className:"text-xs text-green-600",children:"Your number is fully registered and can send SMS."})]})]});if(s.endsWith("_rejected"))return e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-red-50 border border-red-200/60",children:[e.jsx(W,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:"Registration Rejected"}),e.jsx("p",{className:"text-xs text-red-600",children:"Your registration was rejected. Please contact support for assistance."})]})]});if(s==="collecting_info")return e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-amber-50 border border-amber-200/60 mb-6",children:[e.jsx(q,{className:"w-5 h-5 text-amber-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-800",children:"Business Info Required"}),e.jsx("p",{className:"text-xs text-amber-600",children:"Submit your business details below to register your number for SMS."})]})]});const r=[{key:"profile",label:"Profile"},{key:"brand",label:"Brand"},{key:"campaign",label:"Campaign"}],a=s.startsWith("tf_"),i=n=>{var h,b;const p={profile:["brand_pending","brand_approved","campaign_pending","active"],brand:["campaign_pending","active"],campaign:["active"]},o={profile:["profile_pending","profile_approved"],brand:["brand_pending","brand_approved"],campaign:["campaign_pending"]};return(h=p[n])!=null&&h.includes(s)?"completed":(b=o[n])!=null&&b.includes(s)?"current":"pending"};return e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-xl bg-blue-50 border border-blue-200/60",children:[e.jsx(G,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Registration In Progress"}),e.jsx("p",{className:"text-xs text-blue-600 mb-3",children:a?"Your toll-free number is being verified. This typically takes 1-3 business days.":"Your number is being registered with carriers. This typically takes 1-5 business days."}),!a&&e.jsx("div",{className:"flex items-center gap-2",children:r.map((n,p)=>{const o=i(n.key);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${o==="completed"?"bg-green-100 text-green-700":o==="current"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-400"}`,children:[o==="completed"&&e.jsx(O,{className:"w-3 h-3"}),o==="current"&&e.jsx(F,{className:"w-3 h-3 animate-spin"}),n.label]}),p<r.length-1&&e.jsx("div",{className:`w-4 h-px ${o==="completed"?"bg-green-300":"bg-gray-200"}`})]},n.key)})})]})]})}function ce({settings:s}){const{token:r}=L(),[a,i]=l.useState((s==null?void 0:s.crm_type)||"google_sheets"),[n,p]=l.useState(""),[o,h]=l.useState(""),[b,f]=l.useState(!1),[N,j]=l.useState(!1),[u,g]=l.useState(null),S=async()=>{f(!0),g(null);try{const x=await(await fetch("/api/v1/integrations/test",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({crm_type:a,api_key:n,tenant_id:o})})).json();g(x)}catch(t){g({connected:!1,message:t.message})}finally{f(!1)}},c=async()=>{j(!0);try{const t=await fetch("/api/v1/integrations/connect",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({crm_type:a,api_key:n,tenant_id:o})}),x=await t.json();if(!t.ok)throw new Error(x.detail||"Connection failed");g({connected:!0,message:"CRM connected successfully!"})}catch(t){g({connected:!1,message:t.message})}finally{j(!1)}};return e.jsxs("div",{children:[e.jsx(w,{title:"CRM Integration",description:"Connect your CRM for automatic booking sync."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"crm-platform",className:y,children:"CRM Platform"}),e.jsx("select",{id:"crm-platform",value:a,onChange:t=>{i(t.target.value),g(null)},className:`${m} cursor-pointer`,children:te.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),a!=="google_sheets"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"crm-api-key",className:y,children:"API Key"}),e.jsx("input",{id:"crm-api-key",type:"password",value:n,onChange:t=>p(t.target.value),className:m,placeholder:"Enter your API key"})]}),a==="gohighlevel"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"crm-location-id",className:y,children:"Location ID"}),e.jsx("input",{id:"crm-location-id",type:"text",value:o,onChange:t=>h(t.target.value),className:m,placeholder:"Your GoHighLevel location ID"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:S,disabled:b||!n,className:"flex items-center gap-2 px-5 py-2.5 rounded-xl text-sm font-medium border border-gray-200 hover:bg-gray-50 text-gray-700 disabled:opacity-50 transition-colors cursor-pointer",children:[b?e.jsx(F,{className:"w-4 h-4 animate-spin"}):e.jsx(K,{className:"w-4 h-4"}),"Test Connection"]}),e.jsx("button",{onClick:c,disabled:N||!n||!(u!=null&&u.connected),className:"flex items-center gap-2 px-5 py-2.5 rounded-xl text-sm font-medium bg-orange-500 hover:bg-orange-600 text-white disabled:opacity-50 transition-colors cursor-pointer",children:N?"Connecting...":"Connect"})]})]}),u&&e.jsxs("div",{className:`px-4 py-3 rounded-xl text-sm ${u.connected?"bg-green-50 border border-green-200/60 text-green-700":"bg-red-50 border border-red-200/60 text-red-600"}`,children:[u.message,u.technicians_found>0&&e.jsxs("span",{className:"ml-2 text-xs",children:["(",u.technicians_found," team members found)"]})]})]})]})}function de({persona:s,updateConfig:r}){return e.jsxs("div",{children:[e.jsx(w,{title:"AI Persona",description:"Customize how LeadLock AI communicates with your leads."}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"rep-name",className:y,children:"Rep Name"}),e.jsx("input",{id:"rep-name",type:"text",value:s.rep_name||"",onChange:a=>r("persona.rep_name",a.target.value),className:m,placeholder:"e.g. Sarah"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tone",className:y,children:"Tone"}),e.jsx("select",{id:"tone",value:s.tone||"friendly_professional",onChange:a=>r("persona.tone",a.target.value),className:`${m} cursor-pointer`,children:se.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"emergency-phone",className:y,children:"Emergency Contact Phone"}),e.jsx("input",{id:"emergency-phone",type:"text",value:s.emergency_contact_phone||"",onChange:a=>r("persona.emergency_contact_phone",a.target.value),className:m,placeholder:"+15551234567"})]})]})]})}function ue({hours:s,updateConfig:r}){var a,i;return e.jsxs("div",{children:[e.jsx(w,{title:"Business Hours",description:"Set your availability and after-hours behavior."}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"weekday-start",className:y,children:"Weekday Start"}),e.jsx("input",{id:"weekday-start",type:"time",value:((a=s.business)==null?void 0:a.start)||"07:00",onChange:n=>r("hours.business.start",n.target.value),className:m})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"weekday-end",className:y,children:"Weekday End"}),e.jsx("input",{id:"weekday-end",type:"time",value:((i=s.business)==null?void 0:i.end)||"18:00",onChange:n=>r("hours.business.end",n.target.value),className:m})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"after-hours",className:y,children:"After Hours Handling"}),e.jsx("select",{id:"after-hours",value:s.after_hours_handling||"ai_responds_books_next_available",onChange:n=>r("hours.after_hours_handling",n.target.value),className:`${m} cursor-pointer`,children:ae.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))})]})]})]})}function me({services:s,updateConfig:r}){const a=[{label:"Primary Services",key:"services.primary",val:s.primary,id:"primary-services"},{label:"Secondary Services",key:"services.secondary",val:s.secondary,id:"secondary-services"},{label:"Do Not Quote",key:"services.do_not_quote",val:s.do_not_quote,id:"do-not-quote"}];return e.jsxs("div",{children:[e.jsx(w,{title:"Services",description:"Define which services you offer and which to avoid quoting."}),e.jsx("div",{className:"space-y-5",children:a.map(({label:i,key:n,val:p,id:o})=>e.jsxs("div",{children:[e.jsxs("label",{htmlFor:o,className:y,children:[i," ",e.jsx("span",{className:"font-normal text-xs text-gray-400",children:"(comma-separated)"})]}),e.jsx("input",{id:o,type:"text",value:(p||[]).join(", "),onChange:h=>r(n,h.target.value.split(",").map(b=>b.trim()).filter(Boolean)),className:m})]},n))})]})}function xe({config:s,updateConfig:r}){return e.jsxs("div",{children:[e.jsx(w,{title:"Emergency Keywords",description:"Custom keywords that trigger emergency routing."}),e.jsx("label",{htmlFor:"emergency-keywords",className:"sr-only",children:"Emergency keywords"}),e.jsx("input",{id:"emergency-keywords",type:"text",value:(s.emergency_keywords||[]).join(", "),onChange:a=>r("emergency_keywords",a.target.value.split(",").map(i=>i.trim()).filter(Boolean)),className:m,placeholder:"gas leak, no heat, flooding..."}),e.jsx("p",{className:"text-xs text-gray-400 mt-2.5",children:"Default keywords (always active): gas leak, carbon monoxide, fire, flooding, burst pipe, no heat, no ac, sewage, exposed wires"})]})}function Ce(){const[s,r]=l.useState(null),[a,i]=l.useState({}),[n,p]=l.useState(!0),[o,h]=l.useState(!1),[b,f]=l.useState(!1),[N,j]=l.useState(null),[u,g]=l.useState(!1),S=l.useRef(null);l.useEffect(()=>((async()=>{try{const v=await $.getSettings();r(v),i(v.config||{}),g(!1)}catch(v){console.error("Failed to fetch settings:",v),g(!0)}finally{p(!1)}})(),()=>clearTimeout(S.current)),[]);const c=async()=>{h(!0),j(null);try{await $.updateSettings({config:a}),f(!0),clearTimeout(S.current),S.current=setTimeout(()=>f(!1),3e3)}catch(C){j(C.message)}finally{h(!1)}},t=(C,v)=>{i(A=>{const I=JSON.parse(JSON.stringify(A)),_=C.split(".");let k=I;for(let P=0;P<_.length-1;P++)k[_[P]]||(k[_[P]]={}),k=k[_[P]];return k[_[_.length-1]]=v,I})};if(n)return e.jsx("div",{className:"h-96 rounded-xl bg-gray-100 animate-pulse"});const x=a.persona||{},B=a.hours||{},E=a.services||{},R=e.jsxs("button",{onClick:c,disabled:o||u,className:"flex items-center gap-2 bg-orange-500 hover:bg-orange-600 text-white text-sm font-medium px-6 py-2.5 rounded-xl disabled:opacity-50 transition-colors cursor-pointer",children:[b?e.jsx(V,{className:"w-4 h-4"}):e.jsx(Z,{className:"w-4 h-4"}),b?"Saved":o?"Saving...":"Save Changes"]});return e.jsxs("div",{children:[e.jsx(X,{title:"Settings",actions:R}),u&&e.jsx("div",{className:"mb-6 px-4 py-3 rounded-xl bg-red-50 border border-red-200/60 text-red-600 text-sm",children:"Settings failed to load. Please refresh the page before making changes."}),N&&e.jsxs("div",{className:"mb-6 px-4 py-3 rounded-xl flex items-center gap-2.5 text-sm bg-red-50 border border-red-200 text-red-700",children:[e.jsx(U,{className:"w-4 h-4 flex-shrink-0"}),N]}),e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx(ee,{settings:s}),e.jsx(T,{}),e.jsx(ne,{settings:s,onProvisioned:(C,v)=>r(A=>({...A,twilio_phone:C,ten_dlc_status:(v==null?void 0:v.ten_dlc_status)||"collecting_info",twilio_messaging_service_sid:v==null?void 0:v.messaging_service_sid}))}),(s==null?void 0:s.twilio_phone)&&e.jsxs(e.Fragment,{children:[e.jsx(T,{}),e.jsx(le,{settings:s,setSettings:r})]}),e.jsx(T,{}),e.jsx(ce,{settings:s}),e.jsx(T,{}),e.jsx(de,{persona:x,updateConfig:t}),e.jsx(T,{}),e.jsx(ue,{hours:B,updateConfig:t}),e.jsx(T,{}),e.jsx(me,{services:E,updateConfig:t}),e.jsx(T,{}),e.jsx(xe,{config:a,updateConfig:t})]})]})}export{Ce as default};
