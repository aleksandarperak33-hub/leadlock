import{c as k,r as x,j as e,T as b,p as f,M as S,D as O,Z as A,U as G,C as z,f as H}from"./index-BHeaMpcx.js";import{a as q}from"./client-CM7usSQg.js";import{P as V}from"./PageHeader-B70tmnmd.js";import{S as m}from"./StatCard-CoJTE6us.js";import{B as N}from"./Badge-CMg_OOW7.js";import{S as y}from"./StatusDot-BOoImejg.js";import{E as K}from"./EmptyState-OQFNGUqU.js";import{E as C}from"./eye-DHifOSUs.js";import{A as W}from"./activity-DbAn3e2R.js";import{G as L}from"./globe-HM_-l6ef.js";import{R as Y,X,Y as Z,T as J,B as v}from"./generateCategoricalChart-AG-GDjTD.js";import{B as Q}from"./BarChart-dthHADm1.js";import{M as ee}from"./map-pin-HuyXKHLt.js";import{C as te}from"./chevron-up-B8rptYAu.js";import{C as ae}from"./chevron-down-BThlQuyw.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=k("MousePointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=k("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),se=3e4,w={email_sent:{color:"text-blue-600",bg:"bg-blue-50",icon:f},email_opened:{color:"text-emerald-600",bg:"bg-emerald-50",icon:C},email_clicked:{color:"text-orange-600",bg:"bg-orange-50",icon:$},email_replied:{color:"text-orange-600",bg:"bg-orange-50",icon:S},email_bounced:{color:"text-red-600",bg:"bg-red-50",icon:b},scrape_completed:{color:"text-gray-600",bg:"bg-gray-100",icon:L},unsubscribed:{color:"text-amber-600",bg:"bg-amber-50",icon:E}},re={healthy:"success",warning:"warning",unhealthy:"danger",unknown:"neutral"},ne={healthy:"green",warning:"yellow",unhealthy:"red",unknown:"gray"},_=[{key:"cold",label:"Cold",color:"bg-gray-400"},{key:"contacted",label:"Contacted",color:"bg-blue-500"},{key:"demo_scheduled",label:"Demo Scheduled",color:"bg-orange-400"},{key:"demo_completed",label:"Demo Completed",color:"bg-orange-500"},{key:"proposal_sent",label:"Proposal Sent",color:"bg-amber-500"},{key:"won",label:"Won",color:"bg-emerald-500"},{key:"lost",label:"Lost",color:"bg-red-400"}];function le(t){return t==null?"—":t<60?`${t}s`:t<3600?`${Math.floor(t/60)}m`:`${Math.floor(t/3600)}h`}function ce(t){return t.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase())}function ie({workers:t}){const a=Object.entries(t||{});return a.length===0?null:e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:a.map(([r,s])=>{const n=re[s.health]||"neutral";return e.jsxs(N,{variant:n,size:"sm",children:[e.jsx(y,{color:ne[s.health]||"gray"}),e.jsx("span",{className:"ml-1.5",children:ce(r)}),e.jsx("span",{className:"ml-1 text-gray-400 font-mono",children:le(s.age_seconds)}),s.paused&&e.jsx("span",{className:"ml-1 text-amber-600 uppercase text-[10px] font-bold",children:"Paused"})]},r)})})}function de({system:t}){var a,r,s,n,l,i,g,o;return t?e.jsxs("div",{className:"bg-white border border-gray-200/50 rounded-2xl p-5 shadow-card mb-6",children:[e.jsx("div",{className:"mb-3",children:e.jsx(ie,{workers:t.workers})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-5 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(y,{color:(a=t.send_window)!=null&&a.is_active?"green":"gray"}),e.jsx("span",{className:`font-semibold ${(r=t.send_window)!=null&&r.is_active?"text-emerald-700":"text-gray-500"}`,children:(s=t.send_window)!=null&&s.is_active?"LIVE":"PAUSED"}),e.jsx("span",{className:"text-gray-400",children:((n=t.send_window)==null?void 0:n.label)||"Not configured"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(O,{className:"w-3.5 h-3.5 text-gray-400"}),e.jsxs("span",{className:"font-medium text-gray-700 font-mono",children:["$",(((l=t.budget)==null?void 0:l.used_this_month)??0).toFixed(2)," / $",(i=t.budget)==null?void 0:i.monthly_limit]}),e.jsxs("span",{className:`font-semibold ${(((g=t.budget)==null?void 0:g.pct_used)??0)>80?"text-amber-600":"text-gray-400"}`,children:["(",((o=t.budget)==null?void 0:o.pct_used)??0,"%)"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(A,{className:`w-3.5 h-3.5 ${t.engine_active?"text-emerald-500":"text-red-400"}`}),e.jsxs("span",{className:`font-semibold ${t.engine_active?"text-emerald-700":"text-red-600"}`,children:["Engine ",t.engine_active?"Active":"Inactive"]})]})]})]}):null}function oe({funnel:t}){const a=Math.max(..._.map(r=>(t==null?void 0:t[r.key])||0),1);return e.jsxs("div",{className:"bg-white border border-gray-200/50 rounded-2xl p-6 shadow-card",children:[e.jsxs("h2",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[e.jsx(G,{className:"w-3.5 h-3.5"})," Prospect Pipeline"]}),e.jsx("div",{className:"space-y-2.5",children:_.map(({key:r,label:s,color:n})=>{const l=(t==null?void 0:t[r])||0,i=a>0?l/a*100:0;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs font-medium text-gray-600 w-28 truncate",children:s}),e.jsx("div",{className:"flex-1 h-6 bg-gray-100 rounded-md overflow-hidden",children:e.jsx("div",{className:`h-full ${n} rounded-md transition-all duration-500`,style:{width:`${Math.max(i,2)}%`}})}),e.jsx("span",{className:"text-xs font-bold font-mono text-gray-700 w-10 text-right",children:l})]},r)})})]})}function xe({activity:t}){return e.jsxs("div",{className:"bg-white border border-gray-200/50 rounded-2xl p-6 shadow-card",children:[e.jsxs("h2",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[e.jsx(W,{className:"w-3.5 h-3.5"})," Live Activity"]}),e.jsxs("div",{className:"space-y-0.5 max-h-[320px] overflow-y-auto pr-1",children:[(t||[]).length===0&&e.jsx("p",{className:"text-xs text-gray-400 text-center py-4",children:"No recent activity"}),(t||[]).map((a,r)=>{const s=w[a.type]||w.email_sent,n=s.icon,l=a.timestamp?new Date(a.timestamp):null,i=l?l.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return e.jsxs("div",{className:"flex items-start gap-2.5 py-2 border-b border-gray-100 last:border-0",children:[e.jsx("div",{className:`w-6 h-6 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5 ${s.bg}`,children:e.jsx(n,{className:`w-3 h-3 ${s.color}`,strokeWidth:2})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("p",{className:"text-sm text-gray-600 truncate",children:[a.prospect_name&&e.jsx("span",{className:"font-medium text-gray-900",children:a.prospect_name}),a.prospect_name&&" — ",a.detail]})}),e.jsx("span",{className:"text-xs text-gray-400 flex-shrink-0 font-mono",children:i})]},r)})]})]})}function me({sequencePerformance:t}){const a=(t||[]).map(r=>({name:`Step ${(r.step||0)+1}`,"Open %":r.open_rate,"Reply %":r.reply_rate}));return e.jsxs("div",{className:"bg-white border border-gray-200/50 rounded-2xl p-6 shadow-card",children:[e.jsxs("h2",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[e.jsx(z,{className:"w-3.5 h-3.5"})," Sequence Step Performance"]}),a.length>0?e.jsxs(e.Fragment,{children:[e.jsx(Y,{width:"100%",height:200,children:e.jsxs(Q,{data:a,barGap:4,children:[e.jsx(X,{dataKey:"name",tick:{fontSize:11,fill:"#9ca3af"},axisLine:!1,tickLine:!1}),e.jsx(Z,{tick:{fontSize:11,fill:"#9ca3af"},axisLine:!1,tickLine:!1,unit:"%"}),e.jsx(J,{contentStyle:{fontSize:12,borderRadius:12,border:"1px solid #e5e7eb",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},formatter:r=>`${r}%`}),e.jsx(v,{dataKey:"Open %",fill:"#fb923c",radius:[6,6,0,0]}),e.jsx(v,{dataKey:"Reply %",fill:"#10b981",radius:[6,6,0,0]})]})}),e.jsx("div",{className:"mt-3 space-y-1",children:t.map(r=>e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600 px-1",children:[e.jsxs("span",{className:"font-medium",children:["Step ",(r.step||0)+1]}),e.jsxs("span",{className:"font-mono",children:[r.sent," sent"]}),e.jsxs("span",{className:"font-mono",children:[r.open_rate,"% open"]}),e.jsxs("span",{className:"font-mono",children:[r.reply_rate,"% reply"]})]},r.step))})]}):e.jsx("p",{className:"text-xs text-gray-400 text-center py-8",children:"No sequence data yet"})]})}function pe({alerts:t}){return e.jsxs("div",{className:"bg-white border border-gray-200/50 rounded-2xl p-6 shadow-card",children:[e.jsxs("h2",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[e.jsx(H,{className:"w-3.5 h-3.5"})," Alerts & Issues"]}),e.jsxs("div",{className:"space-y-2.5",children:[(t||[]).length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-50 flex items-center justify-center mx-auto mb-2",children:e.jsx(A,{className:"w-5 h-5 text-emerald-500"})}),e.jsx("p",{className:"text-xs text-gray-400",children:"All systems nominal"})]}),(t||[]).map((a,r)=>{const s=a.severity==="critical"?"border-l-red-500":a.severity==="warning"?"border-l-amber-500":"border-l-blue-500",n=a.severity==="critical"?"danger":a.severity==="warning"?"warning":"info";return e.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-xl border border-gray-200/50 border-l-4 ${s}`,children:[e.jsx(N,{variant:n,size:"sm",children:a.severity}),e.jsx("p",{className:"text-sm text-gray-600 flex-1",children:a.message})]},r)})]})]})}function ge({geoPerformance:t}){return(t||[]).length===0?null:e.jsxs("div",{className:"bg-white border border-gray-200/50 rounded-2xl p-6 shadow-card",children:[e.jsxs("h2",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[e.jsx(ee,{className:"w-3.5 h-3.5"})," Geographic Performance"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50/80 border-b border-gray-200/50",children:[e.jsx("th",{className:"text-left py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"City"}),e.jsx("th",{className:"text-left py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"State"}),e.jsx("th",{className:"text-right py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prospects"}),e.jsx("th",{className:"text-right py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Emails Sent"}),e.jsx("th",{className:"text-right py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Open Rate"}),e.jsx("th",{className:"text-right py-3 px-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reply Rate"})]})}),e.jsx("tbody",{children:t.map((a,r)=>e.jsxs("tr",{className:"border-b border-gray-100 last:border-0 hover:bg-gray-50/50 transition-colors",children:[e.jsx("td",{className:"py-3 px-3 font-medium text-gray-900",children:a.city||"—"}),e.jsx("td",{className:"py-3 px-3 text-gray-500",children:a.state||"—"}),e.jsx("td",{className:"py-3 px-3 text-right font-mono text-gray-900",children:a.prospects}),e.jsx("td",{className:"py-3 px-3 text-right font-mono text-gray-900",children:a.emails_sent}),e.jsxs("td",{className:"py-3 px-3 text-right font-mono text-gray-900",children:[a.open_rate,"%"]}),e.jsxs("td",{className:"py-3 px-3 text-right font-mono text-gray-900",children:[a.reply_rate,"%"]})]},r))})]})})]})}function he({scraper:t}){return e.jsxs("div",{className:"bg-white border border-gray-200/50 rounded-2xl p-6 shadow-card",children:[e.jsxs("h2",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[e.jsx(L,{className:"w-3.5 h-3.5"})," Scraper Status"]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider",children:"Total Prospects"}),e.jsx("p",{className:"text-xl font-bold font-mono text-gray-900 mt-1",children:(t==null?void 0:t.total_prospects)||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider",children:"Scraped Today"}),e.jsx("p",{className:"text-xl font-bold font-mono text-gray-900 mt-1",children:(t==null?void 0:t.scraped_today)||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider",children:"New Today"}),e.jsx("p",{className:"text-xl font-bold font-mono text-emerald-600 mt-1",children:(t==null?void 0:t.new_today)||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider",children:"Dupes Today"}),e.jsx("p",{className:"text-xl font-bold font-mono text-gray-500 mt-1",children:(t==null?void 0:t.dupes_today)||0})]})]}),((t==null?void 0:t.locations)||[]).length>0&&e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:t.locations.map((a,r)=>e.jsx("span",{className:"text-xs px-2.5 py-1 rounded-lg bg-gray-50 text-gray-600 font-medium border border-gray-200/50",children:typeof a=="string"?a:`${a.city}, ${a.state}`},r))})]})}function ue({recentEmails:t,expandedEmail:a,setExpandedEmail:r}){return e.jsxs("div",{className:"bg-white border border-gray-200/50 rounded-2xl p-6 shadow-card",children:[e.jsxs("h2",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[e.jsx(f,{className:"w-3.5 h-3.5"})," Recent Emails"]}),(t||[]).length===0?e.jsx("p",{className:"text-xs text-gray-400 text-center py-6",children:"No emails sent yet"}):e.jsx("div",{className:"space-y-1.5",children:t.map(s=>{const n=a===s.id,l=s.sent_at?new Date(s.sent_at):null;return e.jsxs("div",{className:"border border-gray-200/50 rounded-xl overflow-hidden",children:[e.jsxs("button",{onClick:()=>r(n?null:s.id),className:"w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-gray-50/50 transition-colors cursor-pointer",children:[e.jsx(y,{color:s.bounced_at?"red":s.opened_at?"green":"gray"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 w-32 truncate flex-shrink-0",children:s.prospect_name}),e.jsx("span",{className:"text-sm text-gray-500 flex-1 truncate",children:s.subject||`Step ${(s.step||0)+1}`}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsxs(N,{variant:"neutral",size:"sm",children:["Step ",(s.step||0)+1]}),e.jsx("span",{className:"text-xs text-gray-400 font-mono",children:l?l.toLocaleDateString([],{month:"short",day:"numeric"}):""}),n?e.jsx(te,{className:"w-3.5 h-3.5 text-gray-400"}):e.jsx(ae,{className:"w-3.5 h-3.5 text-gray-400"})]})]}),n&&e.jsxs("div",{className:"px-4 pb-4 pt-2 border-t border-gray-100 bg-gray-50/50",children:[e.jsxs("div",{className:"flex gap-3 mb-2 text-xs text-gray-400",children:[s.sent_at&&e.jsxs("span",{children:["Sent: ",e.jsx("span",{className:"font-mono",children:new Date(s.sent_at).toLocaleString()})]}),s.opened_at&&e.jsxs("span",{className:"text-emerald-600",children:["Opened: ",e.jsx("span",{className:"font-mono",children:new Date(s.opened_at).toLocaleString()})]}),s.clicked_at&&e.jsxs("span",{className:"text-orange-600",children:["Clicked: ",e.jsx("span",{className:"font-mono",children:new Date(s.clicked_at).toLocaleString()})]}),s.bounced_at&&e.jsx("span",{className:"text-red-600",children:"Bounced"})]}),e.jsx("p",{className:"text-sm text-gray-500 leading-relaxed",children:s.body_preview||"No preview available"})]})]},s.id)})})]})}function ye(){return e.jsxs("div",{className:"min-h-screen bg-[#FAFAFA] space-y-6",children:[e.jsx("div",{className:"h-8 w-56 rounded-lg bg-gray-100 animate-pulse"}),e.jsx("div",{className:"h-20 rounded-2xl bg-gray-100 animate-pulse"}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-6 gap-4",children:[...Array(6)].map((t,a)=>e.jsx("div",{className:"h-28 rounded-2xl bg-gray-100 animate-pulse"},a))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx("div",{className:"h-72 rounded-2xl bg-gray-100 animate-pulse"}),e.jsx("div",{className:"h-72 rounded-2xl bg-gray-100 animate-pulse"})]})]})}function u(t,a){if(!(!a||a===0))return Math.round((t-a)/a*100)}function Te(){const[t,a]=x.useState(null),[r,s]=x.useState(!0),[n,l]=x.useState(null),[i,g]=x.useState(null),o=x.useCallback(async()=>{try{const p=await q.getCommandCenter();a(p),l(new Date)}catch(p){console.error("Command center fetch failed:",p)}finally{s(!1)}},[]);if(x.useEffect(()=>{o();const p=setInterval(o,se);return()=>clearInterval(p)},[o]),r)return e.jsx(ye,{});if(!t)return e.jsx("div",{className:"min-h-screen bg-[#FAFAFA]",children:e.jsx(K,{icon:b,title:"Unable to load data",description:"Failed to load command center data. Please try again."})});const{system:D,email_pipeline:c,funnel:T,scraper:R,sequence_performance:M,geo_performance:P,recent_emails:F,activity:I,alerts:U}=t,j=(c==null?void 0:c.today)||{},d=(c==null?void 0:c.period_30d)||{},h=(c==null?void 0:c.prev_30d)||{},B=n?`Live · Updated ${n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:"Live";return e.jsxs("div",{className:"min-h-screen bg-[#FAFAFA] space-y-6",children:[e.jsx(V,{title:"Command Center",subtitle:B,actions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{color:"green"}),e.jsx("span",{className:"text-xs font-medium text-gray-400",children:"Auto-refresh 30s"})]})}),e.jsx(de,{system:D}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx(m,{label:"Sent Today",value:`${j.sent||0} / ${j.daily_limit||50}`,icon:f,color:"brand"}),e.jsx(m,{label:"Open Rate",value:`${d.open_rate||0}%`,delta:u(d.open_rate,h.open_rate),deltaLabel:"vs prev 30d",icon:C,color:"green"}),e.jsx(m,{label:"Click Rate",value:`${d.click_rate||0}%`,delta:u(d.click_rate,h.click_rate),deltaLabel:"vs prev 30d",icon:$,color:"brand"}),e.jsx(m,{label:"Reply Rate",value:`${d.reply_rate||0}%`,delta:u(d.reply_rate,h.reply_rate),deltaLabel:"vs prev 30d",icon:S,color:"brand"}),e.jsx(m,{label:"Bounce Rate",value:`${d.bounce_rate||0}%`,delta:u(d.bounce_rate,h.bounce_rate),deltaLabel:"vs prev 30d",icon:b,color:"red"}),e.jsx(m,{label:"Unsubs Today",value:j.unsubscribed||0,icon:E,color:"yellow"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(oe,{funnel:T}),e.jsx(xe,{activity:I})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(me,{sequencePerformance:M}),e.jsx(pe,{alerts:U})]}),e.jsx(ge,{geoPerformance:P}),e.jsx(he,{scraper:R}),e.jsx(ue,{recentEmails:F,expandedEmail:i,setExpandedEmail:g})]})}export{Te as default};
