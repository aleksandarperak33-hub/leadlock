import{u as R,r,j as e,X as B,g as E,h as O}from"./index-BHeaMpcx.js";import{a as w}from"./client-CM7usSQg.js";import{P as D}from"./PageHeader-B70tmnmd.js";import{S as I}from"./SearchInput-Cd1-TkF5.js";import{D as z}from"./DataTable-2VHuwdQk.js";import{B as j}from"./Badge-CMg_OOW7.js";import{P as V}from"./plus-uTLkigTW.js";import"./search-DnPY5eD6.js";import"./chevron-down-BThlQuyw.js";import"./chevron-up-B8rptYAu.js";const p={business_name:"",trade_type:"hvac",tier:"starter",monthly_fee:"497",owner_name:"",owner_email:"",owner_phone:"",dashboard_email:"",dashboard_password:"",crm_type:"google_sheets"},$=a=>{switch(a){case"active":return"success";case"trial":return"info";case"past_due":return"warning";case"cancelled":return"danger";default:return"neutral"}},H=a=>{switch(a){case"enterprise":return"warning";case"scale":return"info";case"growth":return"success";case"starter":return"neutral";default:return"neutral"}},U=[{key:"business_name",label:"Business Name",render:a=>e.jsx("span",{className:"font-medium text-gray-900",children:a})},{key:"trade_type",label:"Trade",render:a=>e.jsx("span",{className:"capitalize text-gray-600",children:a||"—"})},{key:"tier",label:"Tier",render:a=>e.jsx(j,{variant:H(a),size:"sm",children:a||"none"})},{key:"billing_status",label:"Billing",render:a=>e.jsx(j,{variant:$(a),size:"sm",children:(a||"unknown").replace("_"," ")})},{key:"leads_30d",label:"Leads",align:"right",render:a=>e.jsx("span",{className:"font-mono text-gray-900",children:a??"—"})},{key:"booked_30d",label:"Booked",align:"right",render:a=>e.jsx("span",{className:"font-mono text-emerald-600",children:a??"—"})},{key:"conversion_rate",label:"Conversion %",align:"right",render:a=>e.jsx("span",{className:"font-mono text-gray-600",children:a!=null?`${(a*100).toFixed(1)}%`:"—"})},{key:"monthly_fee",label:"MRR",align:"right",render:a=>e.jsxs("span",{className:"font-mono font-medium text-gray-900",children:["$",(a==null?void 0:a.toLocaleString())||"0"]})}],q=[{label:"Business Name",key:"business_name",type:"text",placeholder:"Austin Comfort HVAC",required:!0},{label:"Owner Name",key:"owner_name",type:"text",placeholder:"John Smith"},{label:"Owner Email",key:"owner_email",type:"email",placeholder:"john@business.com"},{label:"Owner Phone",key:"owner_phone",type:"text",placeholder:"+15551234567"},{label:"Dashboard Email",key:"dashboard_email",type:"email",placeholder:"john@business.com"},{label:"Dashboard Password",key:"dashboard_password",type:"password",placeholder:"Set login password"},{label:"Monthly Fee",key:"monthly_fee",type:"number",placeholder:"497"}];function se(){const a=R(),[N,v]=r.useState([]),[_,C]=r.useState(0),[l,g]=r.useState(1),[c,k]=r.useState(1),[d,S]=r.useState(""),[F,x]=r.useState(!0),[A,m]=r.useState(!1),[o,h]=r.useState(p),[b,y]=r.useState(!1),f=async()=>{x(!0);try{const s={page:l,per_page:20};d&&(s.search=d);const t=await w.getAdminClients(s);v(t.clients||[]),C(t.total||0),k(t.pages||1)}catch(s){console.error("Failed to fetch clients:",s)}finally{x(!1)}};r.useEffect(()=>{f()},[l,d]);const M=async()=>{y(!0);try{await w.createAdminClient({...o,monthly_fee:Number(o.monthly_fee)||497}),m(!1),h(p),f()}catch(s){console.error("Failed to create client:",s)}finally{y(!1)}},P=s=>{S(s),g(1)};return e.jsxs("div",{className:"bg-[#FAFAFA] min-h-screen",children:[e.jsx(D,{title:"Clients",actions:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-64",children:e.jsx(I,{value:d,onChange:P,placeholder:"Search clients..."})}),e.jsxs("button",{onClick:()=>{h(p),m(!0)},className:"flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-medium text-white bg-orange-500 hover:bg-orange-600 transition-colors cursor-pointer shadow-sm",children:[e.jsx(V,{className:"w-4 h-4"}),"New Client"]})]})}),A&&e.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-50 flex items-start justify-center pt-24",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-lg w-full shadow-xl border border-gray-200/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"New Client"}),e.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 cursor-pointer transition-colors",children:e.jsx(B,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto",children:[q.map(({label:s,key:t,type:u,placeholder:n,required:i})=>e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-1.5",children:[s,i&&" *"]}),e.jsx("input",{type:u,value:o[t],onChange:T=>h(L=>({...L,[t]:T.target.value})),className:"w-full px-3.5 py-2.5 rounded-xl text-sm bg-white border border-gray-200 text-gray-900 placeholder-gray-400 outline-none focus:border-orange-300 focus:ring-2 focus:ring-orange-100 transition-all",placeholder:n})]},t)),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{label:"Trade Type",key:"trade_type",options:["hvac","plumbing","electrical","roofing","solar","general"]},{label:"Tier",key:"tier",options:["starter","growth","scale","enterprise"]},{label:"CRM",key:"crm_type",options:["google_sheets","service_titan","housecall_pro","jobber","gohighlevel"]}].map(({label:s,key:t,options:u})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wider mb-1.5",children:s}),e.jsx("select",{value:o[t],onChange:n=>h(i=>({...i,[t]:n.target.value})),className:"w-full px-3 py-2.5 rounded-xl text-sm bg-white border border-gray-200 text-gray-900 outline-none focus:border-orange-300 focus:ring-2 focus:ring-orange-100 transition-all cursor-pointer",children:u.map(n=>e.jsx("option",{value:n,children:n.replace(/_/g," ").replace(/\b\w/g,i=>i.toUpperCase())},n))})]},t))}),e.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[e.jsx("button",{onClick:()=>m(!1),className:"flex-1 py-2.5 rounded-xl text-sm font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 transition-colors cursor-pointer",children:"Cancel"}),e.jsx("button",{onClick:M,disabled:b||!o.business_name||!o.trade_type,className:"flex-1 py-2.5 rounded-xl text-sm font-medium text-white bg-orange-500 hover:bg-orange-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer shadow-sm",children:b?"Creating...":"Create Client"})]})]})]})}),F?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((s,t)=>e.jsx("div",{className:"h-14 rounded-2xl bg-gray-100 animate-pulse"},t))}):e.jsx(z,{columns:U,data:N,emptyMessage:"No clients found",onRowClick:s=>a(`/clients/${s.id}`)}),c>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("span",{className:"text-xs font-mono text-gray-400",children:["Page ",l," of ",c," (",_," total)"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>g(s=>Math.max(1,s-1)),disabled:l===1,className:"p-2 rounded-xl text-gray-400 hover:text-gray-600 hover:bg-white border border-transparent hover:border-gray-200/50 transition-colors disabled:opacity-30 disabled:cursor-not-allowed cursor-pointer",children:e.jsx(E,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>g(s=>Math.min(c,s+1)),disabled:l===c,className:"p-2 rounded-xl text-gray-400 hover:text-gray-600 hover:bg-white border border-transparent hover:border-gray-200/50 transition-colors disabled:opacity-30 disabled:cursor-not-allowed cursor-pointer",children:e.jsx(O,{className:"w-4 h-4"})})]})]})]})}export{se as default};
