import{r as n,j as t}from"./index-C6CvHDG0.js";import{a as _}from"./client-BPQvj84Y.js";import{D as N}from"./DataTable-Cx3MEqq4.js";import{P as T}from"./Pagination-CRwjXeWQ.js";import{B as A}from"./Badge-GmErx7Do.js";import"./chevron-down-CVJYLub8.js";import"./chevron-up-CnMI-OlX.js";const R=1e4,E=20,P=[{key:"",label:"All"},{key:"pending",label:"Pending"},{key:"processing",label:"Processing"},{key:"completed",label:"Completed"},{key:"failed",label:"Failed"}],$={completed:"success",failed:"danger",pending:"neutral",processing:"info"};function w(a){if(!a)return"--";const s=(Date.now()-new Date(a).getTime())/1e3;return s<60?`${Math.round(s)}s ago`:s<3600?`${Math.round(s/60)}m ago`:s<86400?`${Math.round(s/3600)}h ago`:`${Math.round(s/86400)}d ago`}function C(a){return a==null?"--":`${a.toFixed(1)}s`}function D(a,s=40){return a?a.length>s?`${a.slice(0,s)}...`:a:"--"}function H(){var f;const[a,s]=n.useState(""),[c,g]=n.useState(1),[l,h]=n.useState({tasks:[],pagination:{total:0,total_pages:1},status_counts:{}}),[k,p]=n.useState(!0),[m,x]=n.useState(null),y=n.useRef(null),d=n.useCallback(async(e={})=>{const o=e.status??a,u=e.page??c;try{const r={per_page:E,page:u};o&&(r.status=o);const i=await _.getAgentTasks(r);h(i.data),x(null)}catch(r){x(r.message||"Failed to load tasks")}finally{p(!1)}},[a,c]);n.useEffect(()=>(p(!0),d(),y.current=setInterval(()=>d(),R),()=>clearInterval(y.current)),[d]);const b=e=>{s(e),g(1)},j=((f=l.pagination)==null?void 0:f.total_pages)??1,S=[{key:"task_type",label:"Type",render:e=>t.jsx("span",{className:"font-mono text-xs",children:e})},{key:"agent",label:"Agent",render:e=>t.jsx("span",{className:"text-sm text-gray-700",children:e||"--"})},{key:"status",label:"Status",render:e=>t.jsx(A,{variant:$[e]||"neutral",size:"sm",children:(e==null?void 0:e.charAt(0).toUpperCase())+(e==null?void 0:e.slice(1))})},{key:"priority",label:"Priority",align:"right",render:e=>t.jsx("span",{className:"font-mono text-xs",children:e??"--"})},{key:"created_at",label:"Created",render:e=>t.jsx("span",{className:"text-xs text-gray-500",children:w(e)})},{key:"duration_s",label:"Duration",align:"right",render:e=>t.jsx("span",{className:"font-mono text-xs",children:C(e)})},{key:"retry_count",label:"Retries",align:"right",render:e=>t.jsx("span",{className:"font-mono text-xs",children:e??0})},{key:"error_message",label:"Error",render:e=>t.jsx("span",{className:"text-xs text-red-500",title:e||void 0,children:D(e)})}];return t.jsxs("div",{className:"space-y-4",children:[m&&t.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-xl text-sm text-red-700",children:m}),t.jsx("div",{className:"flex items-center gap-1 bg-gray-50/80 rounded-xl p-1 w-fit",children:P.map(e=>{var r,i;const o=a===e.key,u=e.key?((r=l.status_counts)==null?void 0:r[e.key])??0:((i=l.pagination)==null?void 0:i.total)??0;return t.jsxs("button",{type:"button",onClick:()=>b(e.key),className:`
                px-3 py-1.5 rounded-lg text-sm font-medium transition-colors cursor-pointer
                inline-flex items-center gap-1.5
                ${o?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}
              `,children:[e.label,t.jsx("span",{className:`
                text-xs font-mono px-1.5 py-0.5 rounded-md
                ${o?"bg-orange-50 text-orange-600":"bg-gray-100 text-gray-400"}
              `,children:u})]},e.key)})}),t.jsx(N,{columns:S,data:l.tasks||[],emptyMessage:"No tasks found",loading:k,loadingRows:5}),t.jsx(T,{page:c,pages:j,onChange:g})]})}export{H as default};
