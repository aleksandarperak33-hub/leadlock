import{c as H,j as e,e as M,r as l,f as D,B as q}from"./index-C6CvHDG0.js";import{a as $}from"./client-BPQvj84Y.js";import{P as X}from"./PageHeader-BjaxPPSz.js";import{P as Y}from"./phone-EElV6Fq9.js";import{L as F}from"./loader-circle-Cu5muWLC.js";import{S as J}from"./search-DsstUW0V.js";import{C as O}from"./circle-check-C_ZTPfFs.js";import{C as W}from"./circle-x-kaMknX3s.js";import{C as U}from"./clock-_j4wTqy7.js";import{P as G}from"./plug-CeTiBi_3.js";import{C as K}from"./circle-alert-CQ0yiEZR.js";import{C as V}from"./check-G1rlX1NV.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=H("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);function S({title:s,description:t}){return e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-1",children:s}),t&&e.jsx("p",{className:"text-sm text-gray-500",children:t})]})}function T(){return e.jsx("div",{className:"border-b border-gray-200/50 pb-8 mb-8"})}function Q(s){return{pending:"Not Started",collecting_info:"Info Needed",profile_pending:"In Review",profile_approved:"In Review",profile_rejected:"Action Required",brand_pending:"In Review",brand_approved:"Almost Ready",brand_rejected:"Action Required",campaign_pending:"Almost Ready",campaign_rejected:"Action Required",tf_verification_pending:"In Review",tf_rejected:"Action Required",active:"Active"}[s]||s||"Not Started"}function ee({settings:s}){const t=[{label:"Business Name",value:s==null?void 0:s.business_name},{label:"Trade Type",value:s==null?void 0:s.trade_type,capitalize:!0},{label:"Twilio Number",value:(s==null?void 0:s.twilio_phone)||"Not assigned"},{label:"Registration",value:Q(s==null?void 0:s.ten_dlc_status),capitalize:!0}];return e.jsxs("div",{children:[e.jsx(S,{title:"Business Information",description:"Read-only details about your account."}),e.jsx("div",{className:"bg-gray-50 border border-gray-200/50 rounded-xl p-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-5",children:t.map(({label:a,value:n,capitalize:i})=>e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-400",children:a}),e.jsx("p",{className:`text-sm mt-0.5 font-medium text-gray-900 ${i?"capitalize":""}`,children:n||"â€”"})]},a))})})]})}const u="w-full px-4 py-2.5 text-sm bg-white border border-gray-200 rounded-xl outline-none focus:border-orange-300 focus:ring-2 focus:ring-orange-100 placeholder:text-gray-400 text-gray-900 transition-all",b="text-sm font-medium text-gray-700 mb-1.5 block",se=[{value:"friendly_professional",label:"Friendly Professional"},{value:"casual",label:"Casual"},{value:"formal",label:"Formal"}],ae=[{value:"ai_responds_books_next_available",label:"AI responds, books next available"},{value:"ai_responds_owner_notified",label:"AI responds, owner notified"},{value:"do_not_respond",label:"Do not respond until business hours"}],te=[{value:"servicetitan",label:"ServiceTitan"},{value:"housecallpro",label:"Housecall Pro"},{value:"jobber",label:"Jobber"},{value:"gohighlevel",label:"GoHighLevel"},{value:"google_sheets",label:"Google Sheets"}],re=[{value:"sole_proprietorship",label:"Sole Proprietorship"},{value:"llc",label:"LLC"},{value:"corporation",label:"Corporation"},{value:"partnership",label:"Partnership"}];function ne({settings:s,onProvisioned:t}){const{token:a}=M(),[n,i]=l.useState(""),[p,o]=l.useState([]),[h,g]=l.useState(!1),[j,N]=l.useState(""),[f,m]=l.useState("");if(s!=null&&s.twilio_phone)return e.jsxs("div",{children:[e.jsx(S,{title:"Phone Number",description:"Your dedicated SMS line."}),e.jsxs("div",{className:"bg-green-50 border border-green-200/60 rounded-xl p-4 flex items-center gap-3",children:[e.jsx(Y,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:s.twilio_phone}),e.jsx("p",{className:"text-xs text-green-600",children:"Active and receiving leads"})]})]})]});const v=async()=>{var c;if(!(!n||n.length!==3)){g(!0),m(""),o([]);try{const r=await fetch(`/api/v1/settings/available-numbers?area_code=${n}`,{headers:{Authorization:`Bearer ${a}`}}),x=await r.json();if(!r.ok)throw new Error(x.detail||"Search failed");o(x.numbers||[]),(c=x.numbers)!=null&&c.length||m("No numbers available for this area code")}catch(r){m(r.message)}finally{g(!1)}}},_=async c=>{N(c),m("");try{const r=await fetch("/api/v1/settings/provision-number",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({phone_number:c})}),x=await r.json();if(!r.ok)throw new Error(x.detail||"Provisioning failed");t(x.phone_number,x)}catch(r){m(r.message)}finally{N("")}};return e.jsxs("div",{children:[e.jsx(S,{title:"Phone Number",description:"Get a dedicated SMS line for your business."}),e.jsxs("div",{className:"flex gap-3 mb-4",children:[e.jsx("input",{id:"area-code",type:"text",value:n,onChange:c=>i(c.target.value.replace(/\D/g,"").slice(0,3)),placeholder:"Area code (e.g. 512)",className:`${u} max-w-[160px]`}),e.jsxs("button",{onClick:v,disabled:h||n.length!==3,className:"flex items-center gap-2 px-5 py-2.5 rounded-xl text-sm font-medium bg-orange-500 hover:bg-orange-600 text-white disabled:opacity-50 transition-colors cursor-pointer",children:[h?e.jsx(F,{className:"w-4 h-4 animate-spin"}):e.jsx(J,{className:"w-4 h-4"}),"Search"]})]}),f&&e.jsx("div",{className:"mb-4 px-4 py-2 rounded-lg bg-red-50 border border-red-200/60 text-red-600 text-sm",children:f}),p.length>0&&e.jsx("div",{className:"space-y-2",children:p.map(c=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 border border-gray-200/50 rounded-xl",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:c.friendly_name}),e.jsxs("p",{className:"text-xs text-gray-400",children:[c.locality,", ",c.region]})]}),e.jsx("button",{onClick:()=>_(c.phone_number),disabled:!!j,className:"px-4 py-2 rounded-lg text-xs font-semibold bg-orange-500 hover:bg-orange-600 text-white disabled:opacity-50 transition-colors cursor-pointer",children:j===c.phone_number?"Provisioning...":"Select"})]},c.phone_number))})]})}function ie({settings:s,setSettings:t}){var I,w,C,P;const{token:a}=M(),[n,i]=l.useState((s==null?void 0:s.business_type)||""),[p,o]=l.useState((s==null?void 0:s.business_ein)||""),[h,g]=l.useState((s==null?void 0:s.business_website)||""),[j,N]=l.useState(((I=s==null?void 0:s.business_address)==null?void 0:I.street)||""),[f,m]=l.useState(((w=s==null?void 0:s.business_address)==null?void 0:w.city)||""),[v,_]=l.useState(((C=s==null?void 0:s.business_address)==null?void 0:C.state)||""),[c,r]=l.useState(((P=s==null?void 0:s.business_address)==null?void 0:P.zip)||""),[x,B]=l.useState(!1),[E,R]=l.useState(""),[k,y]=l.useState(!1),A=async()=>{if(!n){R("Business type is required");return}B(!0),R("");try{const d=await fetch("/api/v1/settings/business-registration",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({business_type:n,business_ein:p,business_website:h,business_address:{street:j,city:f,state:v,zip:c}})}),L=await d.json();if(!d.ok)throw new Error(L.detail||"Registration failed");y(!0),t(z=>({...z,ten_dlc_status:L.status,business_type:n,business_ein:p,business_website:h,business_address:{street:j,city:f,state:v,zip:c}}))}catch(d){R(d.message)}finally{B(!1)}};return k?e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-green-50 border border-green-200/60",children:[e.jsx(O,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Registration Submitted"}),e.jsx("p",{className:"text-xs text-green-600",children:"Your business info has been submitted for review. This typically takes 1-3 business days."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"business-type",className:b,children:"Business Type *"}),e.jsxs("select",{id:"business-type",value:n,onChange:d=>i(d.target.value),className:`${u} cursor-pointer`,children:[e.jsx("option",{value:"",children:"Select business type..."}),re.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"business-ein",className:b,children:["EIN / Tax ID ",n==="sole_proprietorship"?"(optional)":""]}),e.jsx("input",{id:"business-ein",type:"text",value:p,onChange:d=>o(d.target.value.replace(/[^\d-]/g,"").slice(0,11)),className:u,placeholder:"XX-XXXXXXX"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"business-website",className:b,children:"Business Website"}),e.jsx("input",{id:"business-website",type:"url",value:h,onChange:d=>g(d.target.value),className:u,placeholder:"https://yourcompany.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"business-street",className:b,children:"Business Address"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{id:"business-street",type:"text",value:j,onChange:d=>N(d.target.value),className:u,placeholder:"Street address"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("input",{id:"business-city",type:"text",value:f,onChange:d=>m(d.target.value),className:u,placeholder:"City"}),e.jsx("input",{id:"business-state",type:"text",value:v,onChange:d=>_(d.target.value.toUpperCase().slice(0,2)),className:u,placeholder:"State"}),e.jsx("input",{id:"business-zip",type:"text",value:c,onChange:d=>r(d.target.value.replace(/\D/g,"").slice(0,5)),className:u,placeholder:"ZIP"})]})]})]}),E&&e.jsx("div",{className:"px-4 py-2 rounded-lg bg-red-50 border border-red-200/60 text-red-600 text-sm",children:E}),e.jsxs("button",{onClick:A,disabled:x||!n,className:"flex items-center gap-2 px-5 py-2.5 rounded-xl text-sm font-medium bg-orange-500 hover:bg-orange-600 text-white disabled:opacity-50 transition-colors cursor-pointer",children:[x?e.jsx(F,{className:"w-4 h-4 animate-spin"}):e.jsx(D,{className:"w-4 h-4"}),x?"Submitting...":"Submit Registration"]})]})}function le({settings:s,setSettings:t}){const a=(s==null?void 0:s.ten_dlc_status)||"pending",n=a==="collecting_info"&&!(s!=null&&s.business_type);return e.jsxs("div",{children:[e.jsx(S,{title:"SMS Registration",description:"Your number must be registered before it can send outbound SMS."}),e.jsx(oe,{status:a}),n&&e.jsx(ie,{settings:s,setSettings:t})]})}function oe({status:s}){if(s==="active")return e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-green-50 border border-green-200/60",children:[e.jsx(O,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Registration Active"}),e.jsx("p",{className:"text-xs text-green-600",children:"Your number is fully registered and can send SMS."})]})]});if(s.endsWith("_rejected"))return e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-red-50 border border-red-200/60",children:[e.jsx(W,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:"Registration Rejected"}),e.jsx("p",{className:"text-xs text-red-600",children:"Your registration was rejected. Please contact support for assistance."})]})]});if(s==="collecting_info")return e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-amber-50 border border-amber-200/60 mb-6",children:[e.jsx(q,{className:"w-5 h-5 text-amber-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-800",children:"Business Info Required"}),e.jsx("p",{className:"text-xs text-amber-600",children:"Submit your business details below to register your number for SMS."})]})]});const t=[{key:"profile",label:"Profile"},{key:"brand",label:"Brand"},{key:"campaign",label:"Campaign"}],a=s.startsWith("tf_"),n=i=>{var h,g;const p={profile:["brand_pending","brand_approved","campaign_pending","active"],brand:["campaign_pending","active"],campaign:["active"]},o={profile:["profile_pending","profile_approved"],brand:["brand_pending","brand_approved"],campaign:["campaign_pending"]};return(h=p[i])!=null&&h.includes(s)?"completed":(g=o[i])!=null&&g.includes(s)?"current":"pending"};return e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-xl bg-blue-50 border border-blue-200/60",children:[e.jsx(U,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Registration In Progress"}),e.jsx("p",{className:"text-xs text-blue-600 mb-3",children:a?"Your toll-free number is being verified. This typically takes 1-3 business days.":"Your number is being registered with carriers. This typically takes 1-5 business days."}),!a&&e.jsx("div",{className:"flex items-center gap-2",children:t.map((i,p)=>{const o=n(i.key);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${o==="completed"?"bg-green-100 text-green-700":o==="current"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-400"}`,children:[o==="completed"&&e.jsx(O,{className:"w-3 h-3"}),o==="current"&&e.jsx(F,{className:"w-3 h-3 animate-spin"}),i.label]}),p<t.length-1&&e.jsx("div",{className:`w-4 h-px ${o==="completed"?"bg-green-300":"bg-gray-200"}`})]},i.key)})})]})]})}function ce({settings:s}){const{token:t}=M(),[a,n]=l.useState((s==null?void 0:s.crm_type)||"google_sheets"),[i,p]=l.useState(""),[o,h]=l.useState(""),[g,j]=l.useState(!1),[N,f]=l.useState(!1),[m,v]=l.useState(null),_=async()=>{j(!0),v(null);try{const x=await(await fetch("/api/v1/integrations/test",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({crm_type:a,api_key:i,tenant_id:o})})).json();v(x)}catch(r){v({connected:!1,message:r.message})}finally{j(!1)}},c=async()=>{f(!0);try{const r=await fetch("/api/v1/integrations/connect",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({crm_type:a,api_key:i,tenant_id:o})}),x=await r.json();if(!r.ok)throw new Error(x.detail||"Connection failed");v({connected:!0,message:"CRM connected successfully!"})}catch(r){v({connected:!1,message:r.message})}finally{f(!1)}};return e.jsxs("div",{children:[e.jsx(S,{title:"CRM Integration",description:"Connect your CRM for automatic booking sync."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"crm-platform",className:b,children:"CRM Platform"}),e.jsx("select",{id:"crm-platform",value:a,onChange:r=>{n(r.target.value),v(null)},className:`${u} cursor-pointer`,children:te.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),a!=="google_sheets"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"crm-api-key",className:b,children:"API Key"}),e.jsx("input",{id:"crm-api-key",type:"password",value:i,onChange:r=>p(r.target.value),className:u,placeholder:"Enter your API key"})]}),a==="gohighlevel"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"crm-location-id",className:b,children:"Location ID"}),e.jsx("input",{id:"crm-location-id",type:"text",value:o,onChange:r=>h(r.target.value),className:u,placeholder:"Your GoHighLevel location ID"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:_,disabled:g||!i,className:"flex items-center gap-2 px-5 py-2.5 rounded-xl text-sm font-medium border border-gray-200 hover:bg-gray-50 text-gray-700 disabled:opacity-50 transition-colors cursor-pointer",children:[g?e.jsx(F,{className:"w-4 h-4 animate-spin"}):e.jsx(G,{className:"w-4 h-4"}),"Test Connection"]}),e.jsx("button",{onClick:c,disabled:N||!i||!(m!=null&&m.connected),className:"flex items-center gap-2 px-5 py-2.5 rounded-xl text-sm font-medium bg-orange-500 hover:bg-orange-600 text-white disabled:opacity-50 transition-colors cursor-pointer",children:N?"Connecting...":"Connect"})]})]}),m&&e.jsxs("div",{className:`px-4 py-3 rounded-xl text-sm ${m.connected?"bg-green-50 border border-green-200/60 text-green-700":"bg-red-50 border border-red-200/60 text-red-600"}`,children:[m.message,m.technicians_found>0&&e.jsxs("span",{className:"ml-2 text-xs",children:["(",m.technicians_found," team members found)"]})]})]})]})}function de({persona:s,updateConfig:t}){return e.jsxs("div",{children:[e.jsx(S,{title:"AI Persona",description:"Customize how LeadLock AI communicates with your leads."}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"rep-name",className:b,children:"Rep Name"}),e.jsx("input",{id:"rep-name",type:"text",value:s.rep_name||"",onChange:a=>t("persona.rep_name",a.target.value),className:u,placeholder:"e.g. Sarah"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tone",className:b,children:"Tone"}),e.jsx("select",{id:"tone",value:s.tone||"friendly_professional",onChange:a=>t("persona.tone",a.target.value),className:`${u} cursor-pointer`,children:se.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"emergency-phone",className:b,children:"Emergency Contact Phone"}),e.jsx("input",{id:"emergency-phone",type:"text",value:s.emergency_contact_phone||"",onChange:a=>t("persona.emergency_contact_phone",a.target.value),className:u,placeholder:"+15551234567"})]})]})]})}function ue({hours:s,updateConfig:t}){var a,n;return e.jsxs("div",{children:[e.jsx(S,{title:"Business Hours",description:"Set your availability and after-hours behavior."}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"weekday-start",className:b,children:"Weekday Start"}),e.jsx("input",{id:"weekday-start",type:"time",value:((a=s.business)==null?void 0:a.start)||"07:00",onChange:i=>t("hours.business.start",i.target.value),className:u})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"weekday-end",className:b,children:"Weekday End"}),e.jsx("input",{id:"weekday-end",type:"time",value:((n=s.business)==null?void 0:n.end)||"18:00",onChange:i=>t("hours.business.end",i.target.value),className:u})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"after-hours",className:b,children:"After Hours Handling"}),e.jsx("select",{id:"after-hours",value:s.after_hours_handling||"ai_responds_books_next_available",onChange:i=>t("hours.after_hours_handling",i.target.value),className:`${u} cursor-pointer`,children:ae.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})]})]})}function me({services:s,updateConfig:t}){const a=[{label:"Primary Services",key:"services.primary",val:s.primary,id:"primary-services"},{label:"Secondary Services",key:"services.secondary",val:s.secondary,id:"secondary-services"},{label:"Do Not Quote",key:"services.do_not_quote",val:s.do_not_quote,id:"do-not-quote"}];return e.jsxs("div",{children:[e.jsx(S,{title:"Services",description:"Define which services you offer and which to avoid quoting."}),e.jsx("div",{className:"space-y-5",children:a.map(({label:n,key:i,val:p,id:o})=>e.jsxs("div",{children:[e.jsxs("label",{htmlFor:o,className:b,children:[n," ",e.jsx("span",{className:"font-normal text-xs text-gray-400",children:"(comma-separated)"})]}),e.jsx("input",{id:o,type:"text",value:(p||[]).join(", "),onChange:h=>t(i,h.target.value.split(",").map(g=>g.trim()).filter(Boolean)),className:u})]},i))})]})}function xe({config:s,updateConfig:t}){return e.jsxs("div",{children:[e.jsx(S,{title:"Emergency Keywords",description:"Custom keywords that trigger emergency routing."}),e.jsx("label",{htmlFor:"emergency-keywords",className:"sr-only",children:"Emergency keywords"}),e.jsx("input",{id:"emergency-keywords",type:"text",value:(s.emergency_keywords||[]).join(", "),onChange:a=>t("emergency_keywords",a.target.value.split(",").map(n=>n.trim()).filter(Boolean)),className:u,placeholder:"gas leak, no heat, flooding..."}),e.jsx("p",{className:"text-xs text-gray-400 mt-2.5",children:"Default keywords (always active): gas leak, carbon monoxide, fire, flooding, burst pipe, no heat, no ac, sewage, exposed wires"})]})}function pe({config:s,updateConfig:t}){return e.jsxs("div",{children:[e.jsx(S,{title:"Business Metrics",description:"Set your booking link and average job value for ROI tracking."}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"booking-url",className:b,children:"Booking URL"}),e.jsx("input",{id:"booking-url",type:"url",value:s.booking_url||"",onChange:a=>t("booking_url",a.target.value),className:u,placeholder:"https://calendly.com/your-business"}),e.jsx("p",{className:"mt-1.5 text-xs text-gray-400",children:"Used in SMS messages so leads can self-book appointments."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"avg-job-value",className:b,children:"Average Job Value ($)"}),e.jsx("input",{id:"avg-job-value",type:"number",min:"0",step:"1",value:s.avg_job_value??"",onChange:a=>{const n=a.target.value;t("avg_job_value",n===""?null:parseFloat(n))},className:u,placeholder:"e.g. 1500"}),e.jsx("p",{className:"mt-1.5 text-xs text-gray-400",children:"Estimated revenue per booked job. Powers the ROI dashboard calculations."})]})]})]})}function Ce(){const[s,t]=l.useState(null),[a,n]=l.useState({}),[i,p]=l.useState(!0),[o,h]=l.useState(!1),[g,j]=l.useState(!1),[N,f]=l.useState(null),[m,v]=l.useState(!1),_=l.useRef(null);l.useEffect(()=>((async()=>{try{const y=await $.getSettings();t(y),n(y.config||{}),v(!1)}catch(y){console.error("Failed to fetch settings:",y),v(!0)}finally{p(!1)}})(),()=>clearTimeout(_.current)),[]);const c=async()=>{h(!0),f(null);try{await $.updateSettings({config:a}),j(!0),clearTimeout(_.current),_.current=setTimeout(()=>j(!1),3e3)}catch(k){f(k.message)}finally{h(!1)}},r=(k,y)=>{n(A=>{const I=JSON.parse(JSON.stringify(A)),w=k.split(".");let C=I;for(let P=0;P<w.length-1;P++)C[w[P]]||(C[w[P]]={}),C=C[w[P]];return C[w[w.length-1]]=y,I})};if(i)return e.jsx("div",{className:"h-96 rounded-xl bg-gray-100 animate-pulse"});const x=a.persona||{},B=a.hours||{},E=a.services||{},R=e.jsxs("button",{onClick:c,disabled:o||m,className:"flex items-center gap-2 bg-orange-500 hover:bg-orange-600 text-white text-sm font-medium px-6 py-2.5 rounded-xl disabled:opacity-50 transition-colors cursor-pointer",children:[g?e.jsx(V,{className:"w-4 h-4"}):e.jsx(Z,{className:"w-4 h-4"}),g?"Saved":o?"Saving...":"Save Changes"]});return e.jsxs("div",{children:[e.jsx(X,{title:"Settings",actions:R}),m&&e.jsx("div",{className:"mb-6 px-4 py-3 rounded-xl bg-red-50 border border-red-200/60 text-red-600 text-sm",children:"Settings failed to load. Please refresh the page before making changes."}),N&&e.jsxs("div",{className:"mb-6 px-4 py-3 rounded-xl flex items-center gap-2.5 text-sm bg-red-50 border border-red-200 text-red-700",children:[e.jsx(K,{className:"w-4 h-4 flex-shrink-0"}),N]}),e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx(ee,{settings:s}),e.jsx(T,{}),e.jsx(ne,{settings:s,onProvisioned:(k,y)=>t(A=>({...A,twilio_phone:k,ten_dlc_status:(y==null?void 0:y.ten_dlc_status)||"collecting_info",twilio_messaging_service_sid:y==null?void 0:y.messaging_service_sid}))}),(s==null?void 0:s.twilio_phone)&&e.jsxs(e.Fragment,{children:[e.jsx(T,{}),e.jsx(le,{settings:s,setSettings:t})]}),e.jsx(T,{}),e.jsx(ce,{settings:s}),e.jsx(T,{}),e.jsx(pe,{config:a,updateConfig:r}),e.jsx(T,{}),e.jsx(de,{persona:x,updateConfig:r}),e.jsx(T,{}),e.jsx(ue,{hours:B,updateConfig:r}),e.jsx(T,{}),e.jsx(me,{services:E,updateConfig:r}),e.jsx(T,{}),e.jsx(xe,{config:a,updateConfig:r})]})]})}export{Ce as default};
